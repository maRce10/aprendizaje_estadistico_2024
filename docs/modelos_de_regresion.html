<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Aprendizaje Estadístico, SEP-UCR 2024 - Modelos de regresión</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Aprendizaje Estadístico, SEP-UCR 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-manuales" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Manuales</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-manuales">    
        <li>
    <a class="dropdown-item" href="./intro_curso.html">
 <span class="dropdown-text">Introducción al curso</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./fundamentos_de_r.html">
 <span class="dropdown-text">Fundamentos de R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./importar_datos.q’#1E90FF’md">
 <span class="dropdown-text">Importar y exportar datos de R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./como_simular_datos.html">
 <span class="dropdown-text">Como simular datos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./modelos_de_regresion.html">
 <span class="dropdown-text">Modelos de regresión</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ggplot2.html">
 <span class="dropdown-text">Gráficos con ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./preparacion_curso.html"> 
<span class="menu-text">Preparación para el curso</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://codefile.io/f/inMsojTFoN"> 
<span class="menu-text">Compartir código</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./programa.html"> 
<span class="menu-text">Programa</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./instructor.html"> 
<span class="menu-text">Profesor</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maRce10/aprendizaje_estadistico_2024"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul class="collapse">
  <li><a href="#regresión-lineal-en-r" id="toc-regresión-lineal-en-r" class="nav-link active" data-scroll-target="#regresión-lineal-en-r"><span class="header-section-number">1</span> Regresión lineal en R</a>
  <ul class="collapse">
  <li><a href="#modelo-solo-con-intercepto" id="toc-modelo-solo-con-intercepto" class="nav-link" data-scroll-target="#modelo-solo-con-intercepto"><span class="header-section-number">1.1</span> Modelo solo con intercepto</a></li>
  <li><a href="#añadir-un-predictor-no-asociado" id="toc-añadir-un-predictor-no-asociado" class="nav-link" data-scroll-target="#añadir-un-predictor-no-asociado"><span class="header-section-number">1.2</span> Añadir un predictor no asociado</a></li>
  <li><a href="#simular-un-predictor-asociado" id="toc-simular-un-predictor-asociado" class="nav-link" data-scroll-target="#simular-un-predictor-asociado"><span class="header-section-number">1.3</span> Simular un predictor asociado</a></li>
  <li><a href="#varios-predictores-regresión-múltiple" id="toc-varios-predictores-regresión-múltiple" class="nav-link" data-scroll-target="#varios-predictores-regresión-múltiple"><span class="header-section-number">1.4</span> Varios predictores: regresión múltiple</a></li>
  <li><a href="#añadir-un-predictor-categórico" id="toc-añadir-un-predictor-categórico" class="nav-link" data-scroll-target="#añadir-un-predictor-categórico"><span class="header-section-number">1.5</span> Añadir un predictor categórico</a></li>
  <li><a href="#interacciones" id="toc-interacciones" class="nav-link" data-scroll-target="#interacciones"><span class="header-section-number">1.6</span> Interacciones</a></li>
  </ul></li>
  <li><a href="#extender-los-modelos-lineales-a-estructuras-de-datos-más-complejas" id="toc-extender-los-modelos-lineales-a-estructuras-de-datos-más-complejas" class="nav-link" data-scroll-target="#extender-los-modelos-lineales-a-estructuras-de-datos-más-complejas"><span class="header-section-number">2</span> Extender los modelos lineales a estructuras de datos más complejas</a>
  <ul class="collapse">
  <li><a href="#modelos-lineales-generalizados-glm" id="toc-modelos-lineales-generalizados-glm" class="nav-link" data-scroll-target="#modelos-lineales-generalizados-glm"><span class="header-section-number">2.1</span> Modelos lineales generalizados (GLM)</a></li>
  <li><a href="#modelos-de-efectos-variables-modelos-mixtos" id="toc-modelos-de-efectos-variables-modelos-mixtos" class="nav-link" data-scroll-target="#modelos-de-efectos-variables-modelos-mixtos"><span class="header-section-number">2.2</span> Modelos de efectos variables (modelos mixtos)</a></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="header-section-number">2.3</span> Referencias</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><font size="7"><b>Modelos de regresión</b></font></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el código fuente</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">13 de agosto de 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>&nbsp;</p>
<section id="objetivo-del-manual" class="level1 unnumbered unlisted alert alert-info">
<h1 class="unnumbered unlisted">Objetivo del manual</h1>
<p>&nbsp; - Comprender la inferencia estadística a través de los modelos de regresión lineal</p>
<ul>
<li><p>Familiarizarse con la construcción de modelos lineales</p></li>
<li><p>Extender los modelos lineales a diferentes estructuras de datos</p></li>
</ul>
</section>
<p>&nbsp;</p>
<hr>
<p>Paquetes a utilizar en este manual:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># instalar/cargar paquetes</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sketchy<span class="sc">::</span><span class="fu">load_packages</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"ggplot2"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"viridis"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lmerTest"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sjPlot"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp; ::: {.alert .alert-warning} <font size="6"></font></p><font size="6">
<center>
Regresión lineal simple
</center>
</font><p><font size="6"></font></p>
<p>Las regresiones lineales se basan en la ecuación lineal <em>a = mx + b</em> que aprendimos en el colegio. La representación formal tiene este aspecto:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<ul>
<li><p><span class="math inline">\(\hat{Y}\)</span>: variable respuesta</p></li>
<li><p><span class="math inline">\(\beta_{o}\)</span>: intercepto</p></li>
<li><p><span class="math inline">\(\beta_{1}\)</span>: estimado de la magnitud del efecto de <span class="math inline">\(x_{1}\)</span> en <span class="math inline">\(\hat{Y}\)</span> (también conocido como tamaño de efecto, coeficiente o simplemente “estimado”)</p></li>
<li><p><span class="math inline">\(x_{1}\)</span>: variable predictora</p></li>
</ul>
<p>&nbsp;</p>
<p>El objetivo más común de una regresión lineal es la estimación de los valores de <span class="math inline">\(\beta_{*}\)</span>. Esto se consigue encontrando la línea recta que mejor se ajusta y que representa la asociación entre un predictor y la respuesta:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/regression.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Estos <span class="math inline">\(\beta_{*}\)</span> son el tamaño de efecto estimado del predictor correspondiente (por ejemplo, <span class="math inline">\(\beta_{1}\)</span> es el tamaño de efecto <span class="math inline">\(x_{1}\)</span>). Su valor representa el cambio medio en <span class="math inline">\(\hat{Y}\)</span> (en unidades <span class="math inline">\(\hat{Y}\)</span>) para una unidad de cambio en <span class="math inline">\(\beta_{*}\)</span>. Por lo tanto, la hipótesis nula es que esos <span class="math inline">\(\beta_{*}\)</span> no son diferentes de 0:</p>
<center>
<font size="6"><span class="math inline">\(\qquad \mathcal{H}_0: \hat{Y} = \beta_0 + 0 * x_{1}\)</span></font>
</center>
<p>lo que equivale a esto:</p>
<center>
<font size="6"><span class="math inline">\(\qquad \mathcal{H}_0: \hat{Y} = \beta_0\)</span></font>
</center>
<p>&nbsp;</p>
<p>Por ejemplo, un modelo de regresión con este resultado:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/model_betas_esp.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp; :::</p>
<p>&nbsp;</p>
<hr>
<section id="regresión-lineal-en-r" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Regresión lineal en R</h1>
<p>Para sacar el máximo provecho de los modelos lineales necesitamos sentirnos cómodos con ellos. Empezaremos explorando la función de regresión lineal de R <code>lm()</code>. En R la mayoría de los modelos lineales y sus extensiones comparten formatos comunes de entrada de datos y resultados, lo que facilita su aplicación una vez que entendemos sus fundamentos.</p>
<p>Utilizaremos el juego de datos ‘trees’ que viene por defecto con R. ‘trees’ proporciona medidas del <strong>diámetro</strong> (etiquetado como ‘Girth’), <strong>altura</strong> y <strong>volumen</strong> de 31 cerezos talados:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trees)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Girth</th>
<th style="text-align: right;">Height</th>
<th style="text-align: right;">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">8.3</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">10.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.6</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">10.3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.8</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">10.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">16.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10.7</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">18.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.8</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">19.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>La función básica de R para construir un modelo lineal es <code>lm()</code>. Veamos los componentes básicos de un modelo de regresión utilizando <code>lm()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/lm.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos correr este modelo para ver el resultado:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>reg_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Height <span class="sc">~</span> Girth, <span class="at">data =</span> trees)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Height ~ Girth, data = trees)

Residuals:
    Min      1Q  Median      3Q     Max 
-12.582  -2.769   0.316   2.473   9.946 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   62.031      4.383   14.15  1.5e-14 ***
Girth          1.054      0.322    3.27   0.0028 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.54 on 29 degrees of freedom
Multiple R-squared:  0.27,  Adjusted R-squared:  0.244 
F-statistic: 10.7 on 1 and 29 DF,  p-value: 0.00276</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Esto es lo que significan los elementos de la salida:</p>
<ul>
<li><p><strong>Llamada</strong> (call): la función y los parámetros que se utilizaron para crear el modelo</p></li>
<li><p><strong>Residuales</strong> (residuals): distribución de los residuales. Los residuales son la diferencia entre lo que predijo el modelo y el valor real de <em>y</em>. Esta es una representación gráfica de los residuales:</p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li><p><strong>Coeficientes</strong> (coefficients): contiene los tamaños de efecto (‘Estimates’), una medida de su incertidumbre (‘Standar error’), la estadística asociada (‘t value’) y el valor p (‘Pr(&gt;|t|)’). Los tamaño de efecto o estimados se dan como el cambio promedio en <em>y</em> por cada aumento de 1 unidad en <em>x</em>. Para este ejemplo el estimado es de 1,0544 <span class="math inline">\(in / in\)</span>. A pesar de que las unidades se anulan (`1,0544 <span class="math inline">\(in / in\)</span> = 1,0544) tenerlas en cuenta sigue siendo biológicamente significativo. Significan que, en promedio, y un aumento de 1 pulgada en la circunferencia que se espera un aumento de 1,0544 pulgadas en la altura.</p></li>
<li><p><strong>Error estándar de los residuales</strong> (residual standard error): se explica por sí mismo. El error estándar de los residuales</p></li>
<li><p><strong>R-cuadrado múltiple</strong> (multiple R-squared): el coeficiente de determinación, que pretende ser una medida de lo bien que su modelo se ajusta a los datos</p></li>
<li><p><strong>R-cuadrado ajustado</strong> (adjusted R-squared): similar al ‘R-cuadrado múltiple’ pero penalizado por el número de parámetros</p></li>
<li><p><strong>Estadístico F</strong> (F-statistic): estadístico para una prueba global que comprueba si al menos uno de sus coeficientes es distinto de cero</p></li>
<li><p><strong>Valor de p</strong>: probabilidad de una prueba global que comprueba si al menos uno de sus coeficientes es distinto de cero</p></li>
</ul>
<p>&nbsp;</p>
<p>Utilizaremos <code>lm()</code> para mostrar la flexibilidad de los modelos de regresión. Los componentes de regresión se añadirán gradualmente para que podamos tomarnos el tiempo de entender cada uno de ellos así como los correspondientes cambios en la salida de la regresión.</p>
<section id="modelo-solo-con-intercepto" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="modelo-solo-con-intercepto"><span class="header-section-number">1.1</span> Modelo solo con intercepto</h2>
<p>Primero vamos a crear una variable numérica de respuesta:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># put it in a data frame</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>y_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Esta única variable puede introducirse en un <strong>modelo de regresión sólo con intercepto</strong>. Para ello, debemos suministrar la fórmula del modelo y los datos a <code>lm()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run model</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> y_data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Lo que equivale a:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Podemos obtener el resumen por defecto de los resultados del modelo ejecutando <code>summary()</code> en el objeto de salida ‘y_mod’:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(y_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ 1, data = y_data)

Residuals:
   Min     1Q Median     3Q    Max 
-2.001 -0.594 -0.107  0.664  2.135 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.0344     0.1309    0.26     0.79

Residual standard error: 0.926 on 49 degrees of freedom</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Puede ser bastante informativo graficar los tamaños de efecto (aunque en este caso sólo tenemos uno):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(y_mod<span class="sc">$</span>coefficients), </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> y_mod<span class="sc">$</span>coefficients, <span class="fu">confint</span>(y_mod))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Para evaluar la importancia de la asociación nos centramos en la tabla de coeficientes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 0.034404    0.13094 0.26275  0.79385</code></pre>
</div>
</div>
<ul>
<li><p>En este ejemplo no hay predictores en el modelo, por lo que sólo tenemos una estimación para el intercepto (<span class="math inline">\(\beta_0\)</span>)</p></li>
<li><p>El modelo nos dice que el intercepto se estima en 0.0344 y que este valor no es significativamente diferente de 0 (valor p = 0.79385)</p></li>
<li><p>En este caso el intercepto es simplemente la media de la variable de respuesta</p></li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_data<span class="sc">$</span>y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.034404</code></pre>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li>Rara vez tenemos predicciones sobre el intercepto, por lo que tendemos a ignorar esta estimación.</li>
</ul>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Ruhs, E. C., Martin, L. B., &amp; Downs, C. J. (2020). <a href="https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2020.0655?download=true"><strong>The impacts of body mass on immune cell concentrations in birds</strong></a>. <em>Proceedings of the Royal Society B</em>, 287(1934), 20200655.</li>
</ul>
<p>“<em>Encontramos que un modelo sólo con intercepto (intercept-only model) explicaba mejor las concentraciones de linfocitos y eosinófilos en las aves, indicando que las concentraciones de estos tipos de células eran independientes de la masa corporal.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/leukocytes.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 3</font></p>
<p>&nbsp;</p>
<ul>
<li><p>Cambie el argumento ‘mean’ en la llamada de la función “rnorm()` en la simulación para el modelo de solo intercepto un valor distinto de 0 y observe cómo cambian los valores en la tabla de coeficientes</p></li>
<li><p>Cambia el argumento <code>sd</code> en la llamada a la función <code>rnorm()</code> por un valor más alto y observe cómo cambian los valores en la tabla de coeficientes</p></li>
</ul>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="añadir-un-predictor-no-asociado" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="añadir-un-predictor-no-asociado"><span class="header-section-number">1.2</span> Añadir un predictor no asociado</h2>
<p>Podemos crear 2 variables numéricas no relacionadas así:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Estas dos variables pueden introducirse en un modelo de regresión para evaluar la asociación entre ellas:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construir model</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># graficar points</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Que es equivalente a esto:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Imprimamos el resumen de este modelo:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = xy_datos)

Residuals:
   Min     1Q Median     3Q    Max 
-2.004 -0.624 -0.123  0.687  2.106 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.0398     0.1340    0.30     0.77
x1           -0.0367     0.1475   -0.25     0.80

Residual standard error: 0.935 on 48 degrees of freedom
Multiple R-squared:  0.00129,   Adjusted R-squared:  -0.0195 
F-statistic: 0.0618 on 1 and 48 DF,  p-value: 0.805</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>… y graficar los tamaños de efecto:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod<span class="sc">$</span>coefficients), </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Deberíamos “diagnosticar” la idoneidad del modelo inspeccionando más de cerca la distribución de los residuales. La función <code>plot_model()</code> del paquete <code>sjPlot</code> hace un buen trabajo para crear gráficos de diagnóstico para modelos lineales:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(xy_mod, <span class="at">type =</span> <span class="st">"diag"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con coeficientes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error  t value Pr(&gt;|t|)
(Intercept)  0.039774    0.13396  0.29690  0.76782
x1          -0.036679    0.14750 -0.24867  0.80467</code></pre>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li><p>En este ejemplo hemos añadido un predictor al modelo, por lo que hemos obtenido una estimado adicional (y una fila extra, ‘x1’)</p></li>
<li><p>El modelo nos dice que la estimación de ‘x1’ es -0.03668 y que no es significativamente diferente de 0 (p = 0.80467)</p></li>
</ul>
</div>
<hr>
<p>&nbsp;</p>
</section>
<section id="simular-un-predictor-asociado" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="simular-un-predictor-asociado"><span class="header-section-number">1.3</span> Simular un predictor asociado</h2>
<p>Podemos utilizar la fórmula del modelo lineal anterior para simular dos variables continuas asociadas así:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># variables aleatorias</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>xy_datos2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Note que <strong>también hemos añadido un término de error</strong>, por lo que la asociación no es perfecta. Vamos a correr el modelo y graficar la asociación entre las dos variables:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construir model</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>xy_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos2)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos2, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># graficar points</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>La fórmula es la misma que la del modelo anterior:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Este es el resumen del modelo:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = xy_datos2)

Residuals:
   Min     1Q Median     3Q    Max 
 -6.01  -1.87  -0.37   2.06   6.32 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -3.881      0.402   -9.66  7.9e-13 ***
x1             2.890      0.442    6.53  3.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.8 on 48 degrees of freedom
Multiple R-squared:  0.471, Adjusted R-squared:  0.459 
F-statistic: 42.7 on 1 and 48 DF,  p-value: 3.85e-08</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>.. el gráfico con los tamaños de efecto:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod2<span class="sc">$</span>coefficients), </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod2<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod2))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>… y los gráficos diagnósticos del modelo:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(xy_mod2, <span class="at">type =</span> <span class="st">"diag"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -3.8807    0.40188 -9.6562 7.8616e-13
x1            2.8900    0.44249  6.5311 3.8537e-08</code></pre>
</div>
</div>
<ul>
<li><p>El modelo nos dice que <span class="math inline">\(beta_1\)</span> (el tamaño de efecto de ‘x1’) es 2.88996 y que es significativamente diferente de 0 (p = 3.85365^{-8})</p></li>
<li><p>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <code>lm()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><span class="math inline">\(\beta_1\)</span> (the effect size of ‘x1’) was set to 3 and was estimated as 2.89 by the model</li>
</ul></li>
</ul>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Keenan EL, Odom KJ, Araya-Salas M, Horton KG, Strimas-Mackey M, Meatte MA, Mann NI, Slater PJ, Price JJ, and Templeton CN. 2020. <a href="https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2020.2482"><strong>Breeding season length predicts duet coordination and consistency in Neotropical wrens (Troglodytidae)</strong></a>. <em>Proceeding of the Royal Society B</em>. 20202482</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/duets.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>“<em>… la coordinación y la consistencia de los duetos son mayores en las especies con temporadas de apareamiento especialmente largas.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/duet_reg.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 4</font></p>
<p>&nbsp;</p>
<ul>
<li><p>Aumente el tamaño de la muestra (<code>n</code>) a 1000 o más</p></li>
<li><p>¿Cómo cambiaron los estimados del tamaño de efecto (<span class="math inline">\(\beta\)</span>)?</p></li>
<li><p>¿Cómo cambió los intervalos de confianza del tamaño de efecto?</p></li>
<li><p>Ahora cambie <code>n</code> a 15 y compruebe de nuevo las estimaciones del modelo (esta vez compruebe también el valor p)</p></li>
</ul>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="varios-predictores-regresión-múltiple" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="varios-predictores-regresión-múltiple"><span class="header-section-number">1.4</span> Varios predictores: regresión múltiple</h2>
<p>La regresión lineal múltiple es una extensión del modelo de regresión lineal simple que puede tomar varios predictores:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \cdots + \beta_{n} * x_{n}\)</span></font>
</center>
<p>&nbsp;</p>
<p>La fórmula parece compleja, pero sólo quiere decir que cualquier parámetro adicional tendrá su propia estimación (<span class="math inline">\(\beta\)</span>). La fórmula para una regresión lineal de dos predictores se ve así:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2}\)</span></font>
</center>
<p>&nbsp;</p>
<p>… y se puede simular así:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># semila</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># variables aleatorias</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co"># crear un data frame</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>xy_datos_multp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># construir el modelo</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>xy_mod_multp <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos_multp)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod_multp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = xy_datos_multp)

Residuals:
   Min     1Q Median     3Q    Max 
-5.986 -1.893 -0.363  2.002  6.413 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -3.865      0.417   -9.27  3.5e-12 ***
x1             2.901      0.453    6.41  6.4e-08 ***
x2            -1.932      0.414   -4.67  2.6e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.83 on 47 degrees of freedom
Multiple R-squared:  0.612, Adjusted R-squared:  0.595 
F-statistic:   37 on 2 and 47 DF,  p-value: 2.23e-10</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>… graficar los tamaños de efecto:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_multp<span class="sc">$</span>coefficients), </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod_multp<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_multp))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>… y los gráficos diagnósticos:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(xy_mod_multp, <span class="at">type =</span> <span class="st">"diag"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -3.8652    0.41695 -9.2702 3.4856e-12
x1            2.9015    0.45260  6.4108 6.4137e-08
x2           -1.9324    0.41422 -4.6650 2.5851e-05</code></pre>
</div>
</div>
<ul>
<li><p>El modelo encontró que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1’) es 2.9015 y que es significativamente diferente de 0 (p = 6.41368^{-8}). Este es el efecto de ‘x1’ sobre ‘y’ una vez removida la variación explicada por ‘x2’.</p></li>
<li><p>También se encontró que el <span class="math inline">\(\beta_2\)</span> (el tamaño de efecto de ‘x2’) es -1.93235 y que también es significativamente diferente de 0 (p = 2.58513^{-5}). Este es el efecto de ‘x2’ sobre ‘y’ una vez removida la variación explicada por ‘x1’.</p></li>
<li><p>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <code>lm()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span> se fijó en 3 y se estimó como 2.901.</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> (el tamaño de efecto de ‘x2’) se fijó en -2 y se estimó como -1.932.</p></li>
</ul></li>
</ul>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Araya-Salas M, P González-Gómez, K Wojczulanis-Jakubas, V López III &amp; T Wright. 2018. <a href="https://www.nature.com/articles/s41598-018-20441-x"><strong>Spatial memory is as important as weapon and body size for territorial ownership in a lekking hummingbird</strong></a>. <em>Scientific Reports</em>. 13, e0189969</li>
</ul>
<p>“<em>La memoria espacial, el tamaño corporal y el largo de la punta del pico … predijeron positivamente la probabilidad de adquirir y defender un territorio.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/lbh_cognition.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<p>Hay un punto importante que es necesario enfatizar aquí: <strong>la regresión múltiple estima el efecto de un predictor después de tener en cuenta el efecto de los demás predictores del modelo</strong>. En otras palabras, los nuevos predictores del modelo tratarán de explicar la variación de los datos que no fue explicada por los otros predictores. Así que <strong>el resultado de la regresión múltiple no es equivalente a los resultados de las regresiones lineales simples</strong> sobre los mismos predictores. Esto puede demostrarse fácilmente corriendo esas regresiones:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>x1y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>x2y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># atajo a los coeficientes</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(xy_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1 
   0.039774   -0.036679 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(x1y_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1 
   0.039774   -0.036679 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(x2y_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x2 
   0.041320    0.027239 </code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Las estimaciones de las mismas variables varían considerablemente entre la regresión múltiple y las regresiones de un solo predictor.</p>
<p>Este punto se demuestra además por el hecho de que, si uno de los predictores no tiene ninguna influencia en la respuesta, el efecto del predictor adicional convergerá a su efecto en una regresión lineal simple. Para simular este escenario, fijamos b2 en 0:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>x1y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="co"># shortcut to coefficients</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(xy_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1          x2 
  -3.955064    2.967166    0.022549 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(x1y_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1 
    -3.9602      2.9633 </code></pre>
</div>
</div>
<p>El estimado de <span class="math inline">\(\beta_1\)</span> fue casi el mismo en la regresión múltiple (2.96717) y en la regresión de un solo predictor (2.96332)</p>
<p>Por comodidad, hemos utilizado <code>coef()</code> para extraer sólo los estimado de la regresión, pero los valores son los mismos que obtenemos con <code>summary(model)</code>.</p>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 5</font></p>
<p>&nbsp;</p>
<p>La siguiente simulación genera un par de predictores continuos altamente colineales:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias colineales</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span>  x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.2</span>) <span class="co"># hacer x2 colineal con x1</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x1, x2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.97812</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Construya un modelo lineal multiple (con <code>lm()</code>) con ‘y’ como respuesta y ‘x1’ y ‘x2’ como predictores</p></li>
<li><p>Compare los betas estimados por el modelo con los usados para generar los datos. ¿Es una buena estimación?. También observe los valores de p.&nbsp;¿Esperaría que fueran significativos?</p></li>
</ul>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="añadir-un-predictor-categórico" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="añadir-un-predictor-categórico"><span class="header-section-number">1.5</span> Añadir un predictor categórico</h2>
<p>Para los predictores categóricos podemos crear primero una variable binaria (0, 1) y luego añadir etiquetas a cada valor:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>x1_num <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1_num <span class="sc">+</span> error</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1_num, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>xy_datos_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x1_num, y)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_cat)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">x1</th>
<th style="text-align: right;">x1_num</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.66298</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-3.84082</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.32549</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.43804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.42758</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1.75342</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Y así es como se escribe formalmente:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Lo mismo que con los predictores continuos.</p>
<p>Podemos explorar el patrón de los datos utilizando un diagrama de cajas (boxplot):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>… y obtener los estimados del modelo:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>xy_mod_cat <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos_cat)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod_cat)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = xy_datos_cat)

Residuals:
   Min     1Q Median     3Q    Max 
-5.898 -1.909 -0.094  1.809  5.506 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -2.997      0.558   -5.37  2.3e-06 ***
x1b            1.814      0.842    2.16    0.036 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.95 on 48 degrees of freedom
Multiple R-squared:  0.0882,    Adjusted R-squared:  0.0693 
F-statistic: 4.65 on 1 and 48 DF,  p-value: 0.0362</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>… graficar los tamaños de efecto:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_cat<span class="sc">$</span>coefficients), </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod_cat<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_cat))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>… y los gráficos diagnósticos del modelo:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(xy_mod_cat, <span class="at">type =</span> <span class="st">"diag"</span>)[[<span class="dv">2</span>]]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -2.9974    0.55825 -5.3693 2.2677e-06
x1b           1.8140    0.84160  2.1554 3.6172e-02</code></pre>
</div>
</div>
<ul>
<li><p>El modelo encontró que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1’) es 1.814 y que es significativamente diferente de 0 (p = 0.03617)</p></li>
<li><p>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <code>lm()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><span class="math inline">\(\beta_1\)</span> se fijó en 2 y se estimó como 1.814.</li>
</ul></li>
<li><p>Tenga en cuenta que en este caso el intercepto se refiere a la estimación del nivel ‘a’ en el predictor categórico, que se utilizó como base:</p></li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> xy_mod_cat<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Por lo tanto, el intercepto es el mismo que la media de <em>y</em> para la categoría ‘a’:</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xy_datos_cat<span class="sc">$</span>y[xy_datos_cat<span class="sc">$</span>x1 <span class="sc">==</span> <span class="st">"a"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.9974</code></pre>
</div>
</div>
<ul>
<li>Observe también que la etiqueta del estimado es ‘x1b’, no ‘x1’ como en los predictores continuos. Esto se debe a que en este caso el estimado se refiere a la diferencia entre los dos niveles de la variable categórica (‘a’ y ‘b’). Más concretamente, nos dice que en promedio las observaciones de la categoría ‘b’ son 1.814 más altas que las observaciones de la categoría ‘a’.</li>
</ul>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Rico-Guevara A, &amp; M Araya-Salas. 2015. <a href="https://academic.oup.com/beheco/article/26/1/21/2262689"><strong>Bills as daggers? A test for sexually dimorphic weapons in a lekking hummingbird species</strong></a>. <em>Behavioral Ecology</em>. 26 (1): 21-29.</li>
</ul>
<p>“<em>Los machos con puntas de pico más grandes y puntiagudas tuvieron más éxito en ganar control de territorios en el lek.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/daggers_lbh.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 6</font></p>
<p>&nbsp;</p>
<ul>
<li>Los datos desbalanceados cuando hay categorías (es decir, algunas categorías tienen muchas más observaciones que otras) pueden ser problemáticos para la inferencia estadística. Modifique el código arriba para simular un juego de datos muy desbalanceado y compruebe la precisión del modelo.</li>
</ul>
</div>
<hr>
<div class="alert alert-warning">
<p><font size="6"></font></p><font size="6">
<center>
Variables indicadoras (Dummy variables)
</center>
</font><p><font size="6"></font></p>
<p>En un modelo de regresión, los predictores categóricos también se representan como vectores numéricos. Más concretamente, los predictores categóricos se codifican como 0s y 1s, en los que 1 significa “pertenece a la misma categoría” y 0 “pertenece a una categoría diferente”. Mantuvimos el vector numérico original (‘x1_num’) al simular el juego de datos con el predictor categórico:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_cat)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">x1</th>
<th style="text-align: right;">x1_num</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.66298</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-3.84082</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.32549</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.43804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.42758</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1.75342</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Observe que las “b” de la columna “x1” se convierten en 1 en la columna “x1_num” y las “a” se convierten en 0. Esto se denomina variable indicadora y el proceso se conoce como ‘codificación indicadora’ (dummy coding).</p>
<p>En realidad, podemos utilizar el vector numérico en el modelo de regresión y obtener exactamente los mismos resultados:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary model with categorical variable</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod_cat)<span class="sc">$</span>coefficients</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -2.9974    0.55825 -5.3693 2.2677e-06
x1b           1.8140    0.84160  2.1554 3.6172e-02</code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos with dummy variable</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>xy_mod_num <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1_num, <span class="at">data =</span> xy_datos_cat)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary with dummy coding</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod_num)<span class="sc">$</span>coefficients</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -2.9974    0.55825 -5.3693 2.2677e-06
x1_num        1.8140    0.84160  2.1554 3.6172e-02</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Las cosas se complican un poco más cuando se codifica un predictor categórico con más de dos niveles. Pero la lógica es la misma.</p>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="interacciones" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="interacciones"><span class="header-section-number">1.6</span> Interacciones</h2>
<p>Una interacción estadística se refiere a un efecto de una variable predictora que está mediado por una segunda variable.</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2} + \beta_{3} * x_{1} * x_{2}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Esto es más fácil de entender si se observa la interacción de una variable continua y una binaria:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fl">1.7</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="co"># interaccion se añade como el producto dex1 y x2</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> b3 <span class="sc">*</span> x1 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>xy_datos_intr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_intr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1.02557</td>
<td style="text-align: right;">-4.0147</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">-0.28477</td>
<td style="text-align: right;">-5.1746</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">-1.22072</td>
<td style="text-align: right;">-1.3991</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">0.18130</td>
<td style="text-align: right;">-1.0242</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">-0.13889</td>
<td style="text-align: right;">-3.8483</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">0.00576</td>
<td style="text-align: right;">4.1377</td>
</tr>
</tbody>
</table>
</div>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>xy_mod_intr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x1 <span class="sc">*</span> x2, <span class="at">data =</span> xy_datos_intr)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resumen para graficar lineas de mejor ajuste</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>xy_summ_intr <span class="ot">&lt;-</span> <span class="fu">summary</span>(xy_mod_intr)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>xy_summ_intr</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2 + x1 * x2, data = xy_datos_intr)

Residuals:
   Min     1Q Median     3Q    Max 
-6.222 -1.664 -0.158  1.650  6.383 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -4.193      0.570   -7.35  2.7e-09 ***
x1b            3.597      0.806    4.46  5.2e-05 ***
x2             1.327      0.682    1.95   0.0576 .  
x1b:x2        -2.972      0.962   -3.09   0.0034 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.83 on 46 degrees of freedom
Multiple R-squared:  0.396, Adjusted R-squared:  0.357 
F-statistic:   10 on 3 and 46 DF,  p-value: 3.29e-05</code></pre>
</div>
</div>
<p>También ayuda graficar los datos:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_intr, <span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> y, <span class="at">color =</span> x1)) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>… y los tamaños de efecto:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_intr<span class="sc">$</span>coefficients), </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod_intr<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_intr))</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>También deberíamos revisar los gráficos de diagnóstico:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(xy_mod_intr, <span class="at">type =</span> <span class="st">"diag"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-59-3.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-59-4.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -4.1930    0.57023 -7.3532 2.6978e-09
x1b           3.5974    0.80607  4.4629 5.1950e-05
x2            1.3274    0.68161  1.9474 5.7610e-02
x1b:x2       -2.9720    0.96227 -3.0885 3.4061e-03</code></pre>
</div>
</div>
<ul>
<li><p>El modelo encontró que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1-b’ a ‘x1-a’) es 3.59741 y que es significativamente diferente de 0 (valor p = 5.19496^{-5})</p></li>
<li><p>El modelo encontró que <span class="math inline">\(\beta_2\)</span> (el tamaño de efecto de ‘x2’) es 1.32735 y que es significativamente diferente de 0 (p = 0.05761). Esto es en realidad la pendiente de la relación entre x2 e y cuando x1 = `a’</p></li>
<li><p>El modelo encontró que <span class="math inline">\(\beta_3\)</span> (el tamaño de efecto del término de interacción ‘x1 * x2’) es -2.97196 y que es significativamente diferente de 0 (p = 0.00341). Esta es la diferencia entre las pendientes de x2 <em>vs</em> y cuando x1 = ‘a’ y x2 <em>vs</em> y cuando x1 = ‘b’.</p></li>
<li><p>Los valores simulados para los parámetros de regresión pueden compararse con el resumen del modelo <code>lm()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span> se simuló con un valor de 3 y se estimó en 3.597</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> se simuló con un valor de 1.7 y se estimó en 1.327</p></li>
<li><p><span class="math inline">\(\beta_3\)</span> se simuló con un valor de -3 y se estimó en -2.972</p></li>
</ul></li>
</ul>
</div>
<hr>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Chirino F, B Wilink, Araya-Salas M. In prep. <strong>Climatic factors affecting vocal activity in lemur leaf frogs</strong>.</li>
</ul>
<p>“<em>El aumento de la luz de la luna disminuye la actividad vocal de</em> Agalychnis lemur <em>aunque esta relación es mediada por la temperatura.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/lemur.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
</section>
<section id="lectura-understanding-it-depends-in-ecology-a-guide-to-hypothesising-visualising-and-interpreting-statistical-interactions" class="level2 unnumbered unlisted alert alert-warning">
<h2 class="unnumbered unlisted anchored" data-anchor-id="lectura-understanding-it-depends-in-ecology-a-guide-to-hypothesising-visualising-and-interpreting-statistical-interactions">Lectura: <em>Understanding ‘it depends’ in ecology: a guide to hypothesising, visualising and interpreting statistical interactions</em></h2>
<p>Los ecólogos utilizan habitualmente modelos estadísticos para detectar y explicar interacciones entre factores ecológicos, con el objetivo de evaluar si un efecto de interés cambia de signo o magnitud en distintos contextos. El artículo trata de los peligros de interpretan las interacciones estadísticas sin prestar atención a su propiedad fundamental de simetría, o a la escala de medida, ya sea aditiva o multiplicativa. <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/brv.12939">Acá pueden acceder al artículo</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/interaction.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 7</font></p>
<p>&nbsp;</p>
<ul>
<li><p>Modifique el <a href="#simular-un-predictor-asociado">código usado para simular un único predictor asociado</a> aumentando gradualmente el error. Esto se hace aumentando el argumento ‘sd’ en <code>error &lt;- rnorm(n = n, sd = 2)</code>.</p></li>
<li><p>Mire cómo los errores más grandes afectan la inferencia (debe volver a correr los modelos)</p></li>
</ul>
<ul>
<li>Ahora reemplace el término de error con <code>error &lt;- rexp(n = n, rate = 0.2)</code>. Esto crea un error con una distribución exponencial (por lo tanto no normal). Se supone que esto es problemático para el poder inferencial de estos modelos. Compare las estimaciones que obtuvo con los valores de la simulación (‘b0’ y ‘b1’). Explore la distribución de los residuos (<code>plot(nombre_del_modelo)</code>) para los modelos de error ‘normal’ y ‘exponencial’.</li>
</ul>
<ul>
<li>Se supone que la colinealidad (la presencia de predictores correlacionados) afecta a la estabilidad de la regresión múltiple. El siguiente código crea dos predictores altamente colineales (‘x1’ y ‘x2’). La última línea de código muestra la correlación entre ellos.</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co"># hacer x2 muy parecido a x1</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x1, x2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.94642</code></pre>
</div>
</div>
<ul>
<li><p>Construya un modelo de regresión múltiple para estos datos (y ~ x1 + x2). Puede utilizar el mismo código que en la sección <a href="#añadir-más-de-un-predictor:-regresión-múltiple">Añadir más de un predictor: regresión múltiple</a>.</p></li>
<li><p>¿Cómo afecta a la inferencia la presencia de predictores colineales? Realice los gráficos de diagnóstico para este modelo (<code>plot(nombre_del_modelo)</code>).</p></li>
<li><p>Simule un juego de datos con tres predictores en los que sólo dos de ellos son altamente colineales. Ajuste un modelo de regresión múltiple (y ~ x1 + x2 + x3) para esos datos y observe cómo la colinealidad afecta a la estimación del predictor no colineal.</p></li>
</ul>
<p>&nbsp;</p>
</div>
<hr>
</section>
<section id="extender-los-modelos-lineales-a-estructuras-de-datos-más-complejas" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Extender los modelos lineales a estructuras de datos más complejas</h1>
<p>&nbsp;</p>
<section id="modelos-lineales-generalizados-glm" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="modelos-lineales-generalizados-glm"><span class="header-section-number">2.1</span> Modelos lineales generalizados (GLM)</h2>
<p>Los GLM nos permiten modelar la asociación a variables respuesta que no siguen una distribución normal. Además, permiten modelar distribuciones que se asemejan más al proceso que generó los datos. El siguiente código crea un juego de datos con una respuesta que representa cuentas (por lo tanto, no normal):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de muestas</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coeficientes</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="co">#generar variables</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> n, <span class="at">lambda =</span> <span class="fl">6.5</span>) <span class="co"># lambda = tasa promedio de exitos </span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, , <span class="fu">length</span>(y))</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> (<span class="fu">log</span>(y) <span class="sc">-</span> b0 <span class="sc">-</span> b2 <span class="sc">*</span> x2) <span class="sc">/</span> b1</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>xy_datos_pois <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_pois)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.14330</td>
<td style="text-align: right;">-0.50000</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.57378</td>
<td style="text-align: right;">-0.47959</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.57378</td>
<td style="text-align: right;">-0.45918</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.57378</td>
<td style="text-align: right;">-0.43878</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.76710</td>
<td style="text-align: right;">-0.41837</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.57378</td>
<td style="text-align: right;">-0.39796</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>También grafiquemos ‘x1’ <em>vs</em> ‘y’:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos_pois, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>La relación no parece muy lineal ni la varianza parece ser constante a través de ‘x1’.</p>
<p>Podemos relajar el requisito de la distribución normal con GLMs. <code>glm()</code> es una función básica de R que nos ayuda a hacer el truco. Para este ejemplo la distribución más apropiada es <em>Poisson</em>. Esto se puede establecer en el argumento `family’ así:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>glm_pois  <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos_pois, <span class="at">family =</span> <span class="fu">poisson</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Que es equivalente a esto:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim_{poisson} \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Como puede ver el único argumento extra comparado con <code>lm()</code> es <code>family</code>. El resto es simplemente la “fórmula” y los “datos” con los que ya estamos familiarizados. Así que, de nuevo, podemos aprovechar nuestros conocimientos sobre los modelos lineales para extenderlos a estructuras de datos más complejas.</p>
<p>También necesitamos ejecutar <code>summary()</code> para obtener el resultado del modelo:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_pois)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ x1 + x2, family = poisson(), data = xy_datos_pois)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.20e+00   1.29e-01    9.31  &lt; 2e-16 ***
x1          1.30e+00   2.20e-01    5.92  3.2e-09 ***
x2          1.39e-16   1.90e-01    0.00        1    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 3.9471e+01  on 49  degrees of freedom
Residual deviance: 2.2204e-16  on 47  degrees of freedom
AIC: 186.9

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro de los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error    z value   Pr(&gt;|z|)
(Intercept) 1.2000e+00    0.12889 9.3106e+00 1.2709e-20
x1          1.3000e+00    0.21960 5.9200e+00 3.2198e-09
x2          1.3882e-16    0.19016 7.3003e-16 1.0000e+00</code></pre>
</div>
</div>
<ul>
<li><p>El modelo nos dice que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1’) es 1.3 y que es significativamente diferente de 0 (p = 3.21981^{-9}). Esto se interpreta en realidad como que un aumento de 1 unidad de ‘x1’ resulta en ‘y’ (tasa) en un factor de exp(1.3) = 3.6693.</p></li>
<li><p>El modelo también nos dice que <span class="math inline">\(\beta_2\)</span> (el tamaño de efecto de ‘x2’) es 1.38824^{-16} y que es significativamente diferente de 0 (p = 1). Esto significa que un aumento en 1 unidad de ‘x2’ resulta en ‘y’ (tasa) en un factor de exp(1.38824^{-16}) = 1.</p></li>
</ul>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Topp, E. N., Tscharntke, T., &amp; Loos, J. (2022). <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1111/ddi.13257"><strong>Fire and landscape context shape plant and butterfly diversity in a South African shrubland</strong></a>. <em>Diversity and Distributions</em>, 28(3), 357-371.</li>
</ul>
<p>“<em>La riqueza de especies de mariposas es de tres a cuatro veces mayor cuando aumenta el hábitat natural en el paisaje circundante (en un radio de 2 km), mientras que la abundancia de mariposas se asociaba negativamente con el aumento del tiempo transcurrido desde el último incendio.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/butterflies.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 8</font></p>
<p>&nbsp;</p>
<ul>
<li>Intente correr el modelo anterior <code>lm()</code> (con una distribución gaussiana), compare los resultados y compruebe los residuos (<code>plot_model(model_name, type = "diag")</code>)</li>
</ul>
</div>
<p>&nbsp;</p>
<p>Existen muchas otras funciones de distribución y enlace:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/link-functions.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="modelos-de-efectos-variables-modelos-mixtos" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="modelos-de-efectos-variables-modelos-mixtos"><span class="header-section-number">2.2</span> Modelos de efectos variables (modelos mixtos)</h2>
<p>A veces nuestros conjuntos de datos incluyen estructuras con varios niveles de organización. Por ejemplo, cuando tomamos muestras de varios individuos de diferentes poblaciones. En esos casos, la variación en el nivel estructural superior (poblaciones) podría impedir la detección de patrones en el nivel inferior (individuos).</p>
<p>Vamos a simular algunos datos que se asemejan a ese escenario. Tenemos dos predictores continuos (x1) y una respuesta continua (y). Cada muestra procede de 1 de 8 poblaciones diferentes (poblacion):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x&lt;- 1</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>poblacion <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> poblacion <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="co"># add letters</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>poblacion <span class="ot">&lt;-</span> letters[poblacion <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a><span class="co"># create data set</span></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>xy_datos_mixto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y, poblacion)</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_mixto, <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">x1</th>
<th style="text-align: right;">y</th>
<th style="text-align: left;">poblacion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.54607</td>
<td style="text-align: right;">3.3378</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.56834</td>
<td style="text-align: right;">3.1399</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.63855</td>
<td style="text-align: right;">15.2824</td>
<td style="text-align: left;">i</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.98424</td>
<td style="text-align: right;">2.6610</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.05355</td>
<td style="text-align: right;">3.7312</td>
<td style="text-align: left;">b</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.82294</td>
<td style="text-align: right;">3.0189</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.32373</td>
<td style="text-align: right;">3.2186</td>
<td style="text-align: left;">c</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.17854</td>
<td style="text-align: right;">19.0542</td>
<td style="text-align: left;">i</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.26484</td>
<td style="text-align: right;">15.4549</td>
<td style="text-align: left;">i</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.77843</td>
<td style="text-align: right;">11.6670</td>
<td style="text-align: left;">h</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos explorar la relación entre ‘y’ y ‘x1’ con un gráfico:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>¿Puede ver claramente el patrón de asociación entre las dos variables que hemos utilizado para simular los datos? Podemos seguir explorando los datos con un modelo de regresión lineal simple:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos_mixto))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = xy_datos_mixto)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.755  -5.119   0.186   4.602  12.409 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    8.852      0.325   27.21   &lt;2e-16 ***
x1             0.633      0.329    1.92    0.055 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.63 on 298 degrees of freedom
Multiple R-squared:  0.0123,    Adjusted R-squared:  0.00895 
F-statistic:  3.7 on 1 and 298 DF,  p-value: 0.0554</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>A pesar de haber simulado un <span class="math inline">\(\beta_1\)</span> distinto de cero, no tenemos ninguna asociación significativa según este modelo y la estimación de <span class="math inline">\(\beta_1\)</span> está muy lejos de la simulada. Esta pobre inferencia se debe a que estamos ignorando una característica importante de nuestros datos, la agrupación de las muestras en “poblaciones”.</p>
<p>Los modelos de efectos mixtos (también conocidos como modelos multinivel o modelos de efectos variables) pueden ayudarnos a tener en cuenta estas características adicionales, mejorando significativamente nuestro poder de inferencia. Coloreemos cada una de las poblaciones para ver cómo covarían las variables en cada subgrupo de datos:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">color =</span> poblacion)) <span class="sc">+</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Parece haber un patrón claro de asociación positiva entre x1 e y. El patrón se hace un poco más evidente si mostramos cada población en su propio panel:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">color =</span> poblacion)) <span class="sc">+</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> poblacion) <span class="sc">+</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Construyamos un modelo de efectos mixtos utilizando la población como intercepto variable:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>mix_eff_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> poblacion), <span class="at">data =</span> xy_datos_mixto)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Que es equivalente a esto:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim_{gausiana} (\beta_{o} + \beta_{grupo}) + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Podemos ver el resultado del modelo igual que con un modelo <code>lm()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mix_eff_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: y ~ x1 + (1 | poblacion)
   Data: xy_datos_mixto

REML criterion at convergence: 1296.4

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.524 -0.657 -0.032  0.612  3.245 

Random effects:
 Groups    Name        Variance Std.Dev.
 poblacion (Intercept) 30.07    5.48    
 Residual               3.76    1.94    
Number of obs: 300, groups:  poblacion, 9

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)    8.788      1.831   8.003     4.8   0.0014 ** 
x1             1.317      0.115 290.068    11.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
   (Intr)
x1 -0.003</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>El modelo detectó correctamente el patrón simulado y la estimación de <span class="math inline">\(\beta_1\)</span> (1.317) es muy cercana al valor simulado.</p>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Araya-Salas M, P González-Gómez, K Wojczulanis-Jakubas, V López III &amp; T Wright. 2018. <a href="https://www.nature.com/articles/s41598-018-20441-x"><strong>Spatial memory is as important as weapon and body size for territorial ownership in a lekking hummingbird</strong></a>. <em>Scientific Reports</em>. 13, e0189969</li>
</ul>
<p>“<em>… el tamaño corporal mostró una correlación negativa con la frecuencia baja del canto.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/lbh_song_size.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error       df t value   Pr(&gt;|t|)
(Intercept)   8.7881     1.8315   8.0031  4.7983 1.3569e-03
x1            1.3166     0.1151 290.0679 11.4395 2.9326e-25</code></pre>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li><p>El modelo encontró que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1’) es 1.31665 y que es significativamente diferente de 0 (p = 2.93263^{-25})</p></li>
<li><p>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <code>lmer()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><span class="math inline">\(\beta_1\)</span> se fijó en 1.3 y se estimó como 1.317.</li>
</ul></li>
<li><p>La varianza del intercepto para cada población fue de 29.95624 y la desviación estándar de 5.47323</p></li>
<li><p>Los interceptos estimados para cada población son:</p></li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(mix_eff_mod)<span class="sc">$</span>poblacion</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">-8.22835</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">-6.17134</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: right;">-4.23048</td>
</tr>
<tr class="even">
<td style="text-align: left;">d</td>
<td style="text-align: right;">-1.30838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">e</td>
<td style="text-align: right;">0.24573</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">2.22552</td>
</tr>
<tr class="odd">
<td style="text-align: left;">g</td>
<td style="text-align: right;">3.91556</td>
</tr>
<tr class="even">
<td style="text-align: left;">h</td>
<td style="text-align: right;">5.75609</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i</td>
<td style="text-align: right;">7.79566</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li>Podemos compararlos con los promedios para cada población en los datos:</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sumar interceptos por poblacion a el intercepto total</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>interceptos <span class="ot">&lt;-</span> <span class="fu">ranef</span>(mix_eff_mod)<span class="sc">$</span>poblacion <span class="sc">+</span> <span class="fu">fixef</span>(mix_eff_mod)[<span class="dv">1</span>]</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular los promedios por poblacion en los datos </span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>prom_pobs <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(y <span class="sc">~</span> poblacion, xy_datos_mixto, mean)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co"># unir</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(interceptos, <span class="at">prom_pobs=</span> prom_pobs[,<span class="dv">2</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">prom_pobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0.55975</td>
<td style="text-align: right;">0.86151</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">2.61677</td>
<td style="text-align: right;">2.76860</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: right;">4.55762</td>
<td style="text-align: right;">4.90112</td>
</tr>
<tr class="even">
<td style="text-align: left;">d</td>
<td style="text-align: right;">7.47972</td>
<td style="text-align: right;">7.73174</td>
</tr>
<tr class="odd">
<td style="text-align: left;">e</td>
<td style="text-align: right;">9.03384</td>
<td style="text-align: right;">8.87649</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">11.01363</td>
<td style="text-align: right;">10.77650</td>
</tr>
<tr class="odd">
<td style="text-align: left;">g</td>
<td style="text-align: right;">12.70366</td>
<td style="text-align: right;">12.62651</td>
</tr>
<tr class="even">
<td style="text-align: left;">h</td>
<td style="text-align: right;">14.54420</td>
<td style="text-align: right;">14.62110</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i</td>
<td style="text-align: right;">16.58376</td>
<td style="text-align: right;">16.42520</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li>La varianza entre los niveles del factor aleatorio (<code>poblacion</code>) es de 29.95624 y la desviación estándar de 5.47323</li>
</ul>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<section id="la-paradoja-de-simpson" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="la-paradoja-de-simpson"><span class="header-section-number">2.2.1</span> La paradoja de Simpson</h3>
<p>La paradoja de Simpson es un fenómeno en estadística en el que una tendencia aparece en varios grupos de datos pero desaparece o se invierte cuando se combinan los grupos. Se ha utilizado para ilustrar el tipo de resultados engañosos que puede generar el ignorar la estructura en los datos y las relaciones causales entre variables.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/simpsons_paradox.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><font size="3">Tomado de wikipedia</font></p>
<p>&nbsp;</p>
<p>La estructura de los datos debido a observaciones pertenecientes al mismo grupo puede ser tomada en cuenta usando el grupo como un factor aleatorio, tal y como se hizo en el ejemplo anterior.</p>
<p>&nbsp;</p>
<div class="alert alert-info">
<center>
<b><font size="5">Modelos lineales como abordaje estadístico estándar para la inferencia causal </font></b>
</center>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/swiss_knife.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<center>
<font size="5"><span class="math inline">\(\hat{Y} \sim_{función\ de\ enlace} (\beta_{o} + \beta_{grupo}) + \beta_{1} * x_{1} + \cdots + \beta_{n} * x_{n}\)</span></font>
</center>
<ul>
<li><p>Este modelo básico incluye una función de enlace que cuando es gausiana (i.e.&nbsp;normal) equivale a un modelo lineal y cuando no, a un modelo generalizado</p></li>
<li><p>Cuando el <span class="math inline">\(\beta_{grupo}\)</span> es diferente entre grupos (i.e.&nbsp;cuando el intercepto difiere entre grupos) es un modelo mixto con intercepto variable (i.e.&nbsp;aleatorio)</p></li>
</ul>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<p>Este manual solo pretende sugerir un abordaje estadístico centrado en los modelos de regresión desde el cual se pueden llevar a cabo adecuadamente la mayoría de los análisis estadísticos que usamos en biología. <strong>El manual no tiene como objetivo explicar en detalle las particularidades de los modelos generalizados y mixtos</strong>. Note que estos modelos, principalmente los mixtos, pueden adaptarse a otras estructuras de datos mas complejas no cubiertas aquí, como lo son las pendientes aleatorias, pendientes e interceptos aleatorios, estructuras de correlación (i.e.&nbsp;autocorrelación espacial o temporal, pedigrís o árboles filogenéticos), medidas repetidas y el uso de pseudoreplicas, entre otras.</p>
<p>&nbsp;</p>
<hr>
</section>
</section>
<section id="referencias" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="referencias"><span class="header-section-number">2.3</span> Referencias</h2>
<ul>
<li><p><a href="https://github.com/rmcelreath/stat_rethinking_2022">Richard McElreath’s Statistical Rethinking book</a></p></li>
<li><p><a href="https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rbinom/">R’s rbinom – Simulate Binomial or Bernoulli trials</a></p></li>
<li><p><a href="https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rnorm/">R’s rnorm – selecting values from a normal distribution</a></p></li>
<li><p><a href="https://www.programmingr.com/examples/neat-tricks/sample-r-function/rexp/">R’s exp – Simulating Exponential Distributions</a></p></li>
<li><p><a href="https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/">Simulating data in R</a></p></li>
<li><p>Spake, R., Bowler, D. E., Callaghan, C. T., Blowes, S. A., Doncaster, C. P., Antao, L. H., … &amp; Chase, J. M. (2023). <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/brv.12939">Understanding ‘it depends’ in ecology: a guide to hypothesising, visualising and interpreting statistical interactions</a>. Biological Reviews.</p></li>
<li><p><a href="https://www.machinelearningplus.com/machine-learning/complete-introduction-linear-regression-r/">Complete introduction to linear regression in R</a></p></li>
<li><p><a href="https://www.scribbr.com/statistics/linear-regression-in-r/">Linear regression in R</a></p></li>
<li><p>Harrison, X. A., Donaldson, L., Correa-Cano, M. E., Evans, J., Fisher, D. N., Goodwin, C. E., &amp; Inger, R. (2018). <a href="https://peerj.com/articles/4794/">A brief introduction to mixed effects modelling and multi-model inference in ecology</a>. <em>PeerJ</em>, 6, e4794.</p></li>
</ul>
<hr>
</section>
</section>
<section id="información-de-la-sesión" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Información de la sesión</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.4 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       

time zone: America/Costa_Rica
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] car_3.1-2         carData_3.0-5     sjPlot_2.8.16     lmerTest_3.1-3   
 [5] lme4_1.1-35.5     Matrix_1.7-0      viridis_0.6.5     viridisLite_0.4.2
 [9] ggplot2_3.5.1     knitr_1.48       

loaded via a namespace (and not attached):
 [1] gtable_0.3.5        xfun_0.46           htmlwidgets_1.6.4  
 [4] remotes_2.5.0       insight_0.20.2      lattice_0.22-6     
 [7] numDeriv_2016.8-1.1 vctrs_0.6.5         tools_4.4.1        
[10] sjstats_0.19.0      generics_0.1.3      datawizard_0.12.1  
[13] tibble_3.2.1        fansi_1.0.6         pkgconfig_2.0.3    
[16] ggeffects_1.7.0     lifecycle_1.0.4     compiler_4.4.1     
[19] farver_2.1.2        sjmisc_2.8.10       munsell_0.5.1      
[22] sketchy_1.0.3       htmltools_0.5.8.1   yaml_2.3.10        
[25] pillar_1.9.0        nloptr_2.1.1        crayon_1.5.3       
[28] tidyr_1.3.1         MASS_7.3-61         boot_1.3-30        
[31] abind_1.4-5         nlme_3.1-165        tidyselect_1.2.1   
[34] sjlabelled_1.2.0    packrat_0.9.2       digest_0.6.36      
[37] performance_0.12.2  stringi_1.8.4       dplyr_1.1.4        
[40] purrr_1.0.2         labeling_0.4.3      splines_4.4.1      
[43] fastmap_1.2.0       grid_4.4.1          colorspace_2.1-1   
[46] cli_3.6.3           magrittr_2.0.3      utf8_1.2.4         
[49] withr_3.0.1         scales_1.3.0        rmarkdown_2.27     
[52] gridExtra_2.3       evaluate_0.24.0     mgcv_1.9-1         
[55] rlang_1.1.4         Rcpp_1.0.13         glue_1.7.0         
[58] xaringanExtra_0.8.0 rstudioapi_0.16.0   minqa_1.2.7        
[61] jsonlite_1.8.8      R6_2.5.1           </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/marce10\.github\.io\/aprendizaje_estadistico_2024\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb115" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> &lt;font size="7"&gt;&lt;b&gt;Modelos de regresión&lt;/b&gt;&lt;/font&gt;</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,echo=FALSE,message=FALSE}</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="in">options("digits"=5)</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="in">options("digits.secs"=3)</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE, message=FALSE}</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="in">library(viridis)</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="in">library(lmerTest)</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="in">library(sjPlot)</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="in">library(car)</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a><span class="in"># ggplot settings</span></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a><span class="in">geom_histogram &lt;- function(...) ggplot2::geom_histogram(..., fill = viridis(10, alpha = 0.5)[8], show.legend = FALSE, bins = 20, color = "black")</span></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a><span class="in">geom_smooth &lt;- function(...) ggplot2::geom_smooth(..., color = viridis(10,  alpha = 0.5)[8])</span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a><span class="in">geom_boxplot &lt;- function(...) ggplot2::geom_boxplot(..., fill = viridis(10, alpha = 0.5)[7])</span></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a><span class="in">geom_pointrange &lt;- function(...) ggplot2::geom_pointrange(..., show.legend = FALSE, color = viridis(10, alpha = 0.5)[7], size = 2) </span></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a><span class="in">plot_model &lt;- function(...) sjPlot::plot_model(xy_mod, type = "diag", colors = viridis(10, alpha = 0.5)[7])</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_classic(base_size = 20))</span></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a><span class="in">fill &lt;- list(alert = "#cff4fc", success = "#d1e7dd")</span></span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a><span class="fu"># Objetivo del manual {.unnumbered .unlisted}</span></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a><span class="ss">&nbsp; - </span>Comprender la inferencia estadística a través de los modelos de regresión lineal</span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Familiarizarse con la construcción de modelos lineales</span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Extender los modelos lineales a diferentes estructuras de datos</span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a>Paquetes a utilizar en este manual:</span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a><span class="co"># instalar/cargar paquetes</span></span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-62"><a href="#cb115-62" aria-hidden="true" tabindex="-1"></a>sketchy<span class="sc">::</span><span class="fu">load_packages</span>(</span>
<span id="cb115-63"><a href="#cb115-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"ggplot2"</span>, </span>
<span id="cb115-64"><a href="#cb115-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">"viridis"</span>, </span>
<span id="cb115-65"><a href="#cb115-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lmerTest"</span>, </span>
<span id="cb115-66"><a href="#cb115-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sjPlot"</span>)</span>
<span id="cb115-67"><a href="#cb115-67" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb115-68"><a href="#cb115-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-69"><a href="#cb115-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-70"><a href="#cb115-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-71"><a href="#cb115-71" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-72"><a href="#cb115-72" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-73"><a href="#cb115-73" aria-hidden="true" tabindex="-1"></a>&lt;font size = 6&gt;</span>
<span id="cb115-74"><a href="#cb115-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-75"><a href="#cb115-75" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;Regresión lineal simple&lt;/center&gt;</span>
<span id="cb115-76"><a href="#cb115-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-77"><a href="#cb115-77" aria-hidden="true" tabindex="-1"></a>&lt;/font&gt;</span>
<span id="cb115-78"><a href="#cb115-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-79"><a href="#cb115-79" aria-hidden="true" tabindex="-1"></a>Las regresiones lineales se basan en la ecuación lineal *a = mx + b* que aprendimos en el colegio. La representación formal tiene este aspecto:</span>
<span id="cb115-80"><a href="#cb115-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-81"><a href="#cb115-81" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-82"><a href="#cb115-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-83"><a href="#cb115-83" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-84"><a href="#cb115-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-85"><a href="#cb115-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\hat{Y}$: variable respuesta</span>
<span id="cb115-86"><a href="#cb115-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-87"><a href="#cb115-87" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta_{o}$: intercepto</span>
<span id="cb115-88"><a href="#cb115-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-89"><a href="#cb115-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\beta_{1}$: estimado de la magnitud del efecto de $x_{1}$ en $\hat{Y}$ (también conocido como tamaño de efecto, coeficiente o simplemente "estimado")</span>
<span id="cb115-90"><a href="#cb115-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-91"><a href="#cb115-91" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$x_{1}$: variable predictora</span>
<span id="cb115-92"><a href="#cb115-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-93"><a href="#cb115-93" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-94"><a href="#cb115-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-95"><a href="#cb115-95" aria-hidden="true" tabindex="-1"></a>El objetivo más común de una regresión lineal es la estimación de los valores de $\beta_{*}$. Esto se consigue encontrando la línea recta que mejor se ajusta y que representa la asociación entre un predictor y la respuesta:</span>
<span id="cb115-96"><a href="#cb115-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-97"><a href="#cb115-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-98"><a href="#cb115-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-99"><a href="#cb115-99" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/regression.jpg")</span></span>
<span id="cb115-100"><a href="#cb115-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-101"><a href="#cb115-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-102"><a href="#cb115-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-103"><a href="#cb115-103" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-104"><a href="#cb115-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-105"><a href="#cb115-105" aria-hidden="true" tabindex="-1"></a>Estos $\beta_{*}$ son el tamaño de efecto estimado del predictor correspondiente (por ejemplo, $\beta_{1}$ es el tamaño de efecto $x_{1}$). Su valor representa el cambio medio en $\hat{Y}$ (en unidades $\hat{Y}$) para una unidad de cambio en $\beta_{*}$. Por lo tanto, la hipótesis nula es que esos $\beta_{*}$ no son diferentes de 0:</span>
<span id="cb115-106"><a href="#cb115-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-107"><a href="#cb115-107" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\qquad \mathcal{H}_0: \hat{Y} = \beta_0 + 0 * x_{1}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-108"><a href="#cb115-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-109"><a href="#cb115-109" aria-hidden="true" tabindex="-1"></a>lo que equivale a esto:</span>
<span id="cb115-110"><a href="#cb115-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-111"><a href="#cb115-111" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\qquad \mathcal{H}_0: \hat{Y} = \beta_0$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-112"><a href="#cb115-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-113"><a href="#cb115-113" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-114"><a href="#cb115-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-115"><a href="#cb115-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE, eval = FALSE}</span></span>
<span id="cb115-116"><a href="#cb115-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-117"><a href="#cb115-117" aria-hidden="true" tabindex="-1"></a><span class="in">For instance, a regression model with this output:</span></span>
<span id="cb115-118"><a href="#cb115-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-119"><a href="#cb115-119" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)</span></span>
<span id="cb115-120"><a href="#cb115-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-121"><a href="#cb115-121" aria-hidden="true" tabindex="-1"></a><span class="in"># numero de observaciones</span></span>
<span id="cb115-122"><a href="#cb115-122" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 50</span></span>
<span id="cb115-123"><a href="#cb115-123" aria-hidden="true" tabindex="-1"></a><span class="in">b0 &lt;- 1</span></span>
<span id="cb115-124"><a href="#cb115-124" aria-hidden="true" tabindex="-1"></a><span class="in">b1 &lt;- 3</span></span>
<span id="cb115-125"><a href="#cb115-125" aria-hidden="true" tabindex="-1"></a><span class="in">error &lt;- rnorm(n = n, sd = 2)</span></span>
<span id="cb115-126"><a href="#cb115-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-127"><a href="#cb115-127" aria-hidden="true" tabindex="-1"></a><span class="in">#  variables aleatorias</span></span>
<span id="cb115-128"><a href="#cb115-128" aria-hidden="true" tabindex="-1"></a><span class="in">B1 &lt;-  rnorm(n = n, mean = 0, sd = 1)</span></span>
<span id="cb115-129"><a href="#cb115-129" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- b0 + b1 * B1 + error</span></span>
<span id="cb115-130"><a href="#cb115-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-131"><a href="#cb115-131" aria-hidden="true" tabindex="-1"></a><span class="in"># crear data frame</span></span>
<span id="cb115-132"><a href="#cb115-132" aria-hidden="true" tabindex="-1"></a><span class="in">xy_datos &lt;- data.frame(B1, y)</span></span>
<span id="cb115-133"><a href="#cb115-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-134"><a href="#cb115-134" aria-hidden="true" tabindex="-1"></a><span class="in"># construir modelos</span></span>
<span id="cb115-135"><a href="#cb115-135" aria-hidden="true" tabindex="-1"></a><span class="in">xy_mod &lt;- lm(formula = y ~ B1, data = xy_datos)</span></span>
<span id="cb115-136"><a href="#cb115-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-137"><a href="#cb115-137" aria-hidden="true" tabindex="-1"></a><span class="in">summary(xy_mod)$coefficients</span></span>
<span id="cb115-138"><a href="#cb115-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-139"><a href="#cb115-139" aria-hidden="true" tabindex="-1"></a><span class="in">Results in the following predictive model:</span></span>
<span id="cb115-140"><a href="#cb115-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-141"><a href="#cb115-141" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim 1.079 + 2.926 * x_{1}$&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb115-142"><a href="#cb115-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-143"><a href="#cb115-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-144"><a href="#cb115-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-145"><a href="#cb115-145" aria-hidden="true" tabindex="-1"></a>Por ejemplo, un modelo de regresión con este resultado:</span>
<span id="cb115-146"><a href="#cb115-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-147"><a href="#cb115-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "90%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-148"><a href="#cb115-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-149"><a href="#cb115-149" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/model_betas_esp.png")</span></span>
<span id="cb115-150"><a href="#cb115-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-151"><a href="#cb115-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-152"><a href="#cb115-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-153"><a href="#cb115-153" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-154"><a href="#cb115-154" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-155"><a href="#cb115-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-156"><a href="#cb115-156" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-157"><a href="#cb115-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-158"><a href="#cb115-158" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-159"><a href="#cb115-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-160"><a href="#cb115-160" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regresión lineal en R</span></span>
<span id="cb115-161"><a href="#cb115-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-162"><a href="#cb115-162" aria-hidden="true" tabindex="-1"></a>Para sacar el máximo provecho de los modelos lineales necesitamos sentirnos cómodos con ellos. Empezaremos explorando la función de regresión lineal de R <span class="in">`lm()`</span>. En R la mayoría de los modelos lineales y sus extensiones comparten formatos comunes de entrada de datos y resultados, lo que facilita su aplicación una vez que entendemos sus fundamentos.</span>
<span id="cb115-163"><a href="#cb115-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-164"><a href="#cb115-164" aria-hidden="true" tabindex="-1"></a>Utilizaremos el juego de datos 'trees' que viene por defecto con R. 'trees' proporciona medidas del **diámetro** (etiquetado como 'Girth'), **altura** y **volumen** de 31 cerezos talados:</span>
<span id="cb115-165"><a href="#cb115-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-168"><a href="#cb115-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-169"><a href="#cb115-169" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trees)</span>
<span id="cb115-170"><a href="#cb115-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-171"><a href="#cb115-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-172"><a href="#cb115-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-173"><a href="#cb115-173" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-174"><a href="#cb115-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-175"><a href="#cb115-175" aria-hidden="true" tabindex="-1"></a>La función básica de R para construir un modelo lineal es <span class="in">`lm()`</span>. Veamos los componentes básicos de un modelo de regresión utilizando <span class="in">`lm()`</span>:</span>
<span id="cb115-176"><a href="#cb115-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-177"><a href="#cb115-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-178"><a href="#cb115-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-179"><a href="#cb115-179" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/lm.png")</span></span>
<span id="cb115-180"><a href="#cb115-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-181"><a href="#cb115-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-182"><a href="#cb115-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-183"><a href="#cb115-183" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-184"><a href="#cb115-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-185"><a href="#cb115-185" aria-hidden="true" tabindex="-1"></a>Podemos correr este modelo para ver el resultado:</span>
<span id="cb115-186"><a href="#cb115-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-189"><a href="#cb115-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-190"><a href="#cb115-190" aria-hidden="true" tabindex="-1"></a>reg_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Height <span class="sc">~</span> Girth, <span class="at">data =</span> trees)</span>
<span id="cb115-191"><a href="#cb115-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-192"><a href="#cb115-192" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_mod)</span>
<span id="cb115-193"><a href="#cb115-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-194"><a href="#cb115-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-195"><a href="#cb115-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-196"><a href="#cb115-196" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-197"><a href="#cb115-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-198"><a href="#cb115-198" aria-hidden="true" tabindex="-1"></a>Esto es lo que significan los elementos de la salida:</span>
<span id="cb115-199"><a href="#cb115-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-200"><a href="#cb115-200" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Llamada** (call): la función y los parámetros que se utilizaron para crear el modelo</span>
<span id="cb115-201"><a href="#cb115-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-202"><a href="#cb115-202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Residuales** (residuals): distribución de los residuales. Los residuales son la diferencia entre lo que predijo el modelo y el valor real de *y*. Esta es una representación gráfica de los residuales:</span>
<span id="cb115-203"><a href="#cb115-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-204"><a href="#cb115-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb115-205"><a href="#cb115-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-206"><a href="#cb115-206" aria-hidden="true" tabindex="-1"></a><span class="in"># añadir valores predichos</span></span>
<span id="cb115-207"><a href="#cb115-207" aria-hidden="true" tabindex="-1"></a><span class="in">trees$predicted &lt;- reg_mod$fitted.values</span></span>
<span id="cb115-208"><a href="#cb115-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-209"><a href="#cb115-209" aria-hidden="true" tabindex="-1"></a><span class="in"># graficar</span></span>
<span id="cb115-210"><a href="#cb115-210" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(trees, aes(x = Girth, y = Height)) + </span></span>
<span id="cb115-211"><a href="#cb115-211" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", se = FALSE) +  </span></span>
<span id="cb115-212"><a href="#cb115-212" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Diámetro (Girth)", y = "Alto (height)") +</span></span>
<span id="cb115-213"><a href="#cb115-213" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_segment(aes(xend = Girth, yend = predicted), alpha = .2) +</span></span>
<span id="cb115-214"><a href="#cb115-214" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()</span></span>
<span id="cb115-215"><a href="#cb115-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-216"><a href="#cb115-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-217"><a href="#cb115-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-218"><a href="#cb115-218" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-219"><a href="#cb115-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-220"><a href="#cb115-220" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Coeficientes** (coefficients): contiene los tamaños de efecto ('Estimates'), una medida de su incertidumbre ('Standar error'), la estadística asociada ('t value') y el valor p ('Pr(<span class="sc">\&gt;</span>\|t\|)'). Los tamaño de efecto o estimados se dan como el cambio promedio en *y* por cada aumento de 1 unidad en *x*. Para este ejemplo el estimado es de 1,0544 $in / in$. A pesar de que las unidades se anulan (<span class="sc">\`</span>1,0544 $in / in$ = 1,0544) tenerlas en cuenta sigue siendo biológicamente significativo. Significan que, en promedio, y un aumento de 1 pulgada en la circunferencia que se espera un aumento de 1,0544 pulgadas en la altura.</span>
<span id="cb115-221"><a href="#cb115-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-222"><a href="#cb115-222" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Error estándar de los residuales** (residual standard error): se explica por sí mismo. El error estándar de los residuales</span>
<span id="cb115-223"><a href="#cb115-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-224"><a href="#cb115-224" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**R-cuadrado múltiple** (multiple R-squared): el coeficiente de determinación, que pretende ser una medida de lo bien que su modelo se ajusta a los datos</span>
<span id="cb115-225"><a href="#cb115-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-226"><a href="#cb115-226" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**R-cuadrado ajustado** (adjusted R-squared): similar al 'R-cuadrado múltiple' pero penalizado por el número de parámetros</span>
<span id="cb115-227"><a href="#cb115-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-228"><a href="#cb115-228" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Estadístico F** (F-statistic): estadístico para una prueba global que comprueba si al menos uno de sus coeficientes es distinto de cero</span>
<span id="cb115-229"><a href="#cb115-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-230"><a href="#cb115-230" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Valor de p**: probabilidad de una prueba global que comprueba si al menos uno de sus coeficientes es distinto de cero</span>
<span id="cb115-231"><a href="#cb115-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-232"><a href="#cb115-232" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-233"><a href="#cb115-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-234"><a href="#cb115-234" aria-hidden="true" tabindex="-1"></a>Utilizaremos <span class="in">`lm()`</span> para mostrar la flexibilidad de los modelos de regresión. Los componentes de regresión se añadirán gradualmente para que podamos tomarnos el tiempo de entender cada uno de ellos así como los correspondientes cambios en la salida de la regresión.</span>
<span id="cb115-235"><a href="#cb115-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-236"><a href="#cb115-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelo solo con intercepto</span></span>
<span id="cb115-237"><a href="#cb115-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-238"><a href="#cb115-238" aria-hidden="true" tabindex="-1"></a>Primero vamos a crear una variable numérica de respuesta:</span>
<span id="cb115-239"><a href="#cb115-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-242"><a href="#cb115-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-243"><a href="#cb115-243" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-244"><a href="#cb115-244" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-245"><a href="#cb115-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-246"><a href="#cb115-246" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-247"><a href="#cb115-247" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-248"><a href="#cb115-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-249"><a href="#cb115-249" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb115-250"><a href="#cb115-250" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-251"><a href="#cb115-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-252"><a href="#cb115-252" aria-hidden="true" tabindex="-1"></a><span class="co"># put it in a data frame</span></span>
<span id="cb115-253"><a href="#cb115-253" aria-hidden="true" tabindex="-1"></a>y_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y)</span>
<span id="cb115-254"><a href="#cb115-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-255"><a href="#cb115-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-256"><a href="#cb115-256" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-257"><a href="#cb115-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-258"><a href="#cb115-258" aria-hidden="true" tabindex="-1"></a>Esta única variable puede introducirse en un **modelo de regresión sólo con intercepto**. Para ello, debemos suministrar la fórmula del modelo y los datos a <span class="in">`lm()`</span>:</span>
<span id="cb115-259"><a href="#cb115-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-262"><a href="#cb115-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-263"><a href="#cb115-263" aria-hidden="true" tabindex="-1"></a><span class="co"># run model</span></span>
<span id="cb115-264"><a href="#cb115-264" aria-hidden="true" tabindex="-1"></a>y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> y_data)</span>
<span id="cb115-265"><a href="#cb115-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-266"><a href="#cb115-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-267"><a href="#cb115-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-268"><a href="#cb115-268" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-269"><a href="#cb115-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-270"><a href="#cb115-270" aria-hidden="true" tabindex="-1"></a>Lo que equivale a:</span>
<span id="cb115-271"><a href="#cb115-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-272"><a href="#cb115-272" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim \beta_{o}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-273"><a href="#cb115-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-274"><a href="#cb115-274" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-275"><a href="#cb115-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-276"><a href="#cb115-276" aria-hidden="true" tabindex="-1"></a>Podemos obtener el resumen por defecto de los resultados del modelo ejecutando <span class="in">`summary()`</span> en el objeto de salida 'y_mod':</span>
<span id="cb115-277"><a href="#cb115-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-280"><a href="#cb115-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-281"><a href="#cb115-281" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(y_mod)</span>
<span id="cb115-282"><a href="#cb115-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-283"><a href="#cb115-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-284"><a href="#cb115-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-285"><a href="#cb115-285" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-286"><a href="#cb115-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-287"><a href="#cb115-287" aria-hidden="true" tabindex="-1"></a>Puede ser bastante informativo graficar los tamaños de efecto (aunque en este caso sólo tenemos uno):</span>
<span id="cb115-288"><a href="#cb115-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-291"><a href="#cb115-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-292"><a href="#cb115-292" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(y_mod<span class="sc">$</span>coefficients), </span>
<span id="cb115-293"><a href="#cb115-293" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> y_mod<span class="sc">$</span>coefficients, <span class="fu">confint</span>(y_mod))</span>
<span id="cb115-294"><a href="#cb115-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-295"><a href="#cb115-295" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb115-296"><a href="#cb115-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-297"><a href="#cb115-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb115-298"><a href="#cb115-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb115-299"><a href="#cb115-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb115-300"><a href="#cb115-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-301"><a href="#cb115-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-302"><a href="#cb115-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-303"><a href="#cb115-303" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-304"><a href="#cb115-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-305"><a href="#cb115-305" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb115-306"><a href="#cb115-306" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-307"><a href="#cb115-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-308"><a href="#cb115-308" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Interpretación del modelo&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-309"><a href="#cb115-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-310"><a href="#cb115-310" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-311"><a href="#cb115-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-312"><a href="#cb115-312" aria-hidden="true" tabindex="-1"></a>Para evaluar la importancia de la asociación nos centramos en la tabla de coeficientes:</span>
<span id="cb115-313"><a href="#cb115-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-314"><a href="#cb115-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb115-315"><a href="#cb115-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-316"><a href="#cb115-316" aria-hidden="true" tabindex="-1"></a><span class="in">summ_y_mod &lt;- summary(y_mod)</span></span>
<span id="cb115-317"><a href="#cb115-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-318"><a href="#cb115-318" aria-hidden="true" tabindex="-1"></a><span class="in">summ_y_mod$coefficients</span></span>
<span id="cb115-319"><a href="#cb115-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-320"><a href="#cb115-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-321"><a href="#cb115-321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>En este ejemplo no hay predictores en el modelo, por lo que sólo tenemos una estimación para el intercepto ($\beta_0$)</span>
<span id="cb115-322"><a href="#cb115-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-323"><a href="#cb115-323" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo nos dice que el intercepto se estima en <span class="in">`r summ_y_mod$coefficients[1, 1]`</span> y que este valor no es significativamente diferente de 0 (valor p = <span class="in">`r summ_y_mod$coefficients[1, 4]`</span>)</span>
<span id="cb115-324"><a href="#cb115-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-325"><a href="#cb115-325" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>En este caso el intercepto es simplemente la media de la variable de respuesta</span>
<span id="cb115-326"><a href="#cb115-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-329"><a href="#cb115-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-330"><a href="#cb115-330" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_data<span class="sc">$</span>y)</span>
<span id="cb115-331"><a href="#cb115-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-332"><a href="#cb115-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-333"><a href="#cb115-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-334"><a href="#cb115-334" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-335"><a href="#cb115-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-336"><a href="#cb115-336" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rara vez tenemos predicciones sobre el intercepto, por lo que tendemos a ignorar esta estimación.</span>
<span id="cb115-337"><a href="#cb115-337" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-338"><a href="#cb115-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-339"><a href="#cb115-339" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-340"><a href="#cb115-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-341"><a href="#cb115-341" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-342"><a href="#cb115-342" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Caso de estudio&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-343"><a href="#cb115-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-344"><a href="#cb115-344" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-345"><a href="#cb115-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-346"><a href="#cb115-346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ruhs, E. C., Martin, L. B., &amp; Downs, C. J. (2020). <span class="co">[</span><span class="ot">**The impacts of body mass on immune cell concentrations in birds**</span><span class="co">](https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2020.0655?download=true)</span>. *Proceedings of the Royal Society B*, 287(1934), 20200655.</span>
<span id="cb115-347"><a href="#cb115-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-348"><a href="#cb115-348" aria-hidden="true" tabindex="-1"></a>"*Encontramos que un modelo sólo con intercepto (intercept-only model) explicaba mejor las concentraciones de linfocitos y eosinófilos en las aves, indicando que las concentraciones de estos tipos de células eran independientes de la masa corporal.*"</span>
<span id="cb115-349"><a href="#cb115-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-350"><a href="#cb115-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "85%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-351"><a href="#cb115-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-352"><a href="#cb115-352" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/leukocytes.png")</span></span>
<span id="cb115-353"><a href="#cb115-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-354"><a href="#cb115-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-355"><a href="#cb115-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-356"><a href="#cb115-356" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-357"><a href="#cb115-357" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-358"><a href="#cb115-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-359"><a href="#cb115-359" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-360"><a href="#cb115-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-361"><a href="#cb115-361" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb115-362"><a href="#cb115-362" aria-hidden="true" tabindex="-1"></a>&lt;font size="5"&gt;Ejercicio 3&lt;/font&gt;</span>
<span id="cb115-363"><a href="#cb115-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-364"><a href="#cb115-364" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-365"><a href="#cb115-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-366"><a href="#cb115-366" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cambie el argumento 'mean' en la llamada de la función "rnorm()<span class="sc">\`</span> en la simulación para el modelo de solo intercepto un valor distinto de 0 y observe cómo cambian los valores en la tabla de coeficientes</span>
<span id="cb115-367"><a href="#cb115-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-368"><a href="#cb115-368" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cambia el argumento <span class="in">`sd`</span> en la llamada a la función <span class="in">`rnorm()`</span> por un valor más alto y observe cómo cambian los valores en la tabla de coeficientes</span>
<span id="cb115-369"><a href="#cb115-369" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-370"><a href="#cb115-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-371"><a href="#cb115-371" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-372"><a href="#cb115-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-373"><a href="#cb115-373" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-374"><a href="#cb115-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-375"><a href="#cb115-375" aria-hidden="true" tabindex="-1"></a><span class="fu">## Añadir un predictor no asociado</span></span>
<span id="cb115-376"><a href="#cb115-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-377"><a href="#cb115-377" aria-hidden="true" tabindex="-1"></a>Podemos crear 2 variables numéricas no relacionadas así:</span>
<span id="cb115-378"><a href="#cb115-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-381"><a href="#cb115-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-382"><a href="#cb115-382" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-383"><a href="#cb115-383" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-384"><a href="#cb115-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-385"><a href="#cb115-385" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-386"><a href="#cb115-386" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-387"><a href="#cb115-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-388"><a href="#cb115-388" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb115-389"><a href="#cb115-389" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-390"><a href="#cb115-390" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-391"><a href="#cb115-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-392"><a href="#cb115-392" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb115-393"><a href="#cb115-393" aria-hidden="true" tabindex="-1"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span>
<span id="cb115-394"><a href="#cb115-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-395"><a href="#cb115-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-396"><a href="#cb115-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-397"><a href="#cb115-397" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-398"><a href="#cb115-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-399"><a href="#cb115-399" aria-hidden="true" tabindex="-1"></a>Estas dos variables pueden introducirse en un modelo de regresión para evaluar la asociación entre ellas:</span>
<span id="cb115-400"><a href="#cb115-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-403"><a href="#cb115-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-404"><a href="#cb115-404" aria-hidden="true" tabindex="-1"></a><span class="co"># construir model</span></span>
<span id="cb115-405"><a href="#cb115-405" aria-hidden="true" tabindex="-1"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb115-406"><a href="#cb115-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-407"><a href="#cb115-407" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb115-408"><a href="#cb115-408" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb115-409"><a href="#cb115-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb115-410"><a href="#cb115-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># graficar points</span></span>
<span id="cb115-411"><a href="#cb115-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-412"><a href="#cb115-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-413"><a href="#cb115-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-414"><a href="#cb115-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-415"><a href="#cb115-415" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-416"><a href="#cb115-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-417"><a href="#cb115-417" aria-hidden="true" tabindex="-1"></a>Que es equivalente a esto:</span>
<span id="cb115-418"><a href="#cb115-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-419"><a href="#cb115-419" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-420"><a href="#cb115-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-421"><a href="#cb115-421" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-422"><a href="#cb115-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-423"><a href="#cb115-423" aria-hidden="true" tabindex="-1"></a>Imprimamos el resumen de este modelo:</span>
<span id="cb115-424"><a href="#cb115-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-427"><a href="#cb115-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-428"><a href="#cb115-428" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod)</span>
<span id="cb115-429"><a href="#cb115-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-430"><a href="#cb115-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-431"><a href="#cb115-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-432"><a href="#cb115-432" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-433"><a href="#cb115-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-434"><a href="#cb115-434" aria-hidden="true" tabindex="-1"></a>... y graficar los tamaños de efecto:</span>
<span id="cb115-435"><a href="#cb115-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-438"><a href="#cb115-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-439"><a href="#cb115-439" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod<span class="sc">$</span>coefficients), </span>
<span id="cb115-440"><a href="#cb115-440" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod))</span>
<span id="cb115-441"><a href="#cb115-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-442"><a href="#cb115-442" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb115-443"><a href="#cb115-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-444"><a href="#cb115-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb115-445"><a href="#cb115-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb115-446"><a href="#cb115-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb115-447"><a href="#cb115-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-448"><a href="#cb115-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-449"><a href="#cb115-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-450"><a href="#cb115-450" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-451"><a href="#cb115-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-452"><a href="#cb115-452" aria-hidden="true" tabindex="-1"></a>Deberíamos "diagnosticar" la idoneidad del modelo inspeccionando más de cerca la distribución de los residuales. La función <span class="in">`plot_model()`</span> del paquete <span class="in">`sjPlot`</span> hace un buen trabajo para crear gráficos de diagnóstico para modelos lineales:</span>
<span id="cb115-453"><a href="#cb115-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-454"><a href="#cb115-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb115-455"><a href="#cb115-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-456"><a href="#cb115-456" aria-hidden="true" tabindex="-1"></a><span class="in">plot_model(xy_mod, type = "diag")</span></span>
<span id="cb115-457"><a href="#cb115-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-458"><a href="#cb115-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-459"><a href="#cb115-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-460"><a href="#cb115-460" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-461"><a href="#cb115-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-462"><a href="#cb115-462" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb115-463"><a href="#cb115-463" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-464"><a href="#cb115-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-465"><a href="#cb115-465" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Interpretación del modelo&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-466"><a href="#cb115-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-467"><a href="#cb115-467" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-468"><a href="#cb115-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-469"><a href="#cb115-469" aria-hidden="true" tabindex="-1"></a>Cuadro con coeficientes:</span>
<span id="cb115-470"><a href="#cb115-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-471"><a href="#cb115-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb115-472"><a href="#cb115-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-473"><a href="#cb115-473" aria-hidden="true" tabindex="-1"></a><span class="in">summ_xy_mod &lt;- summary(xy_mod)</span></span>
<span id="cb115-474"><a href="#cb115-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-475"><a href="#cb115-475" aria-hidden="true" tabindex="-1"></a><span class="in">summ_xy_mod$coefficients</span></span>
<span id="cb115-476"><a href="#cb115-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-477"><a href="#cb115-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-478"><a href="#cb115-478" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-479"><a href="#cb115-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-480"><a href="#cb115-480" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>En este ejemplo hemos añadido un predictor al modelo, por lo que hemos obtenido una estimado adicional (y una fila extra, 'x1')</span>
<span id="cb115-481"><a href="#cb115-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-482"><a href="#cb115-482" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo nos dice que la estimación de 'x1' es <span class="in">`r summ_xy_mod$coefficients[2, 1]`</span> y que no es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod$coefficients[2, 4]`</span>)</span>
<span id="cb115-483"><a href="#cb115-483" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-484"><a href="#cb115-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-485"><a href="#cb115-485" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-486"><a href="#cb115-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-487"><a href="#cb115-487" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-488"><a href="#cb115-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-489"><a href="#cb115-489" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simular un predictor asociado {#simular-un-predictor-asociado}</span></span>
<span id="cb115-490"><a href="#cb115-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-491"><a href="#cb115-491" aria-hidden="true" tabindex="-1"></a>Podemos utilizar la fórmula del modelo lineal anterior para simular dos variables continuas asociadas así:</span>
<span id="cb115-492"><a href="#cb115-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-495"><a href="#cb115-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-496"><a href="#cb115-496" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-497"><a href="#cb115-497" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-498"><a href="#cb115-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-499"><a href="#cb115-499" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-500"><a href="#cb115-500" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-501"><a href="#cb115-501" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb115-502"><a href="#cb115-502" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb115-503"><a href="#cb115-503" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb115-504"><a href="#cb115-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-505"><a href="#cb115-505" aria-hidden="true" tabindex="-1"></a><span class="co"># variables aleatorias</span></span>
<span id="cb115-506"><a href="#cb115-506" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-507"><a href="#cb115-507" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb115-508"><a href="#cb115-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-509"><a href="#cb115-509" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb115-510"><a href="#cb115-510" aria-hidden="true" tabindex="-1"></a>xy_datos2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span>
<span id="cb115-511"><a href="#cb115-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-512"><a href="#cb115-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-513"><a href="#cb115-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-514"><a href="#cb115-514" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-515"><a href="#cb115-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-516"><a href="#cb115-516" aria-hidden="true" tabindex="-1"></a>Note que **también hemos añadido un término de error**, por lo que la asociación no es perfecta. Vamos a correr el modelo y graficar la asociación entre las dos variables:</span>
<span id="cb115-517"><a href="#cb115-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-520"><a href="#cb115-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-521"><a href="#cb115-521" aria-hidden="true" tabindex="-1"></a><span class="co"># construir model</span></span>
<span id="cb115-522"><a href="#cb115-522" aria-hidden="true" tabindex="-1"></a>xy_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos2)</span>
<span id="cb115-523"><a href="#cb115-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-524"><a href="#cb115-524" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb115-525"><a href="#cb115-525" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos2, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb115-526"><a href="#cb115-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb115-527"><a href="#cb115-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co"># graficar points</span></span>
<span id="cb115-528"><a href="#cb115-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-529"><a href="#cb115-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-530"><a href="#cb115-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-531"><a href="#cb115-531" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-532"><a href="#cb115-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-533"><a href="#cb115-533" aria-hidden="true" tabindex="-1"></a>La fórmula es la misma que la del modelo anterior:</span>
<span id="cb115-534"><a href="#cb115-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-535"><a href="#cb115-535" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-536"><a href="#cb115-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-537"><a href="#cb115-537" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-538"><a href="#cb115-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-539"><a href="#cb115-539" aria-hidden="true" tabindex="-1"></a>Este es el resumen del modelo:</span>
<span id="cb115-540"><a href="#cb115-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-543"><a href="#cb115-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-544"><a href="#cb115-544" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod2)</span>
<span id="cb115-545"><a href="#cb115-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-546"><a href="#cb115-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-547"><a href="#cb115-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-548"><a href="#cb115-548" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-549"><a href="#cb115-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-550"><a href="#cb115-550" aria-hidden="true" tabindex="-1"></a>.. el gráfico con los tamaños de efecto:</span>
<span id="cb115-551"><a href="#cb115-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-554"><a href="#cb115-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-555"><a href="#cb115-555" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod2<span class="sc">$</span>coefficients), </span>
<span id="cb115-556"><a href="#cb115-556" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod2<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod2))</span>
<span id="cb115-557"><a href="#cb115-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-558"><a href="#cb115-558" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb115-559"><a href="#cb115-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-560"><a href="#cb115-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb115-561"><a href="#cb115-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb115-562"><a href="#cb115-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb115-563"><a href="#cb115-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-564"><a href="#cb115-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-565"><a href="#cb115-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-566"><a href="#cb115-566" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-567"><a href="#cb115-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-568"><a href="#cb115-568" aria-hidden="true" tabindex="-1"></a>... y los gráficos diagnósticos del modelo:</span>
<span id="cb115-569"><a href="#cb115-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-570"><a href="#cb115-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb115-571"><a href="#cb115-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-572"><a href="#cb115-572" aria-hidden="true" tabindex="-1"></a><span class="in">plot_model(xy_mod2, type = "diag")</span></span>
<span id="cb115-573"><a href="#cb115-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-574"><a href="#cb115-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-575"><a href="#cb115-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-576"><a href="#cb115-576" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-577"><a href="#cb115-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-578"><a href="#cb115-578" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb115-579"><a href="#cb115-579" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-580"><a href="#cb115-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-581"><a href="#cb115-581" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Interpretación del modelo&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-582"><a href="#cb115-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-583"><a href="#cb115-583" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-584"><a href="#cb115-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-585"><a href="#cb115-585" aria-hidden="true" tabindex="-1"></a>Cuadro con los coeficientes (estimados):</span>
<span id="cb115-586"><a href="#cb115-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-587"><a href="#cb115-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb115-588"><a href="#cb115-588" aria-hidden="true" tabindex="-1"></a><span class="in"># resumen</span></span>
<span id="cb115-589"><a href="#cb115-589" aria-hidden="true" tabindex="-1"></a><span class="in">summ_xy_mod2 &lt;- summary(xy_mod2)</span></span>
<span id="cb115-590"><a href="#cb115-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-591"><a href="#cb115-591" aria-hidden="true" tabindex="-1"></a><span class="in">summ_xy_mod2$coefficients</span></span>
<span id="cb115-592"><a href="#cb115-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-593"><a href="#cb115-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-594"><a href="#cb115-594" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo nos dice que $beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_xy_mod2$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod2$coefficients[2, 4]`</span>)</span>
<span id="cb115-595"><a href="#cb115-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-596"><a href="#cb115-596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lm()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb115-597"><a href="#cb115-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-598"><a href="#cb115-598" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_1$ (the effect size of 'x1') was set to <span class="in">`r b1`</span> and was estimated as <span class="in">`r round(summ_xy_mod2$coefficients[2, 1], 3)`</span> by the model</span>
<span id="cb115-599"><a href="#cb115-599" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-600"><a href="#cb115-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-601"><a href="#cb115-601" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-602"><a href="#cb115-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-603"><a href="#cb115-603" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-604"><a href="#cb115-604" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Caso de estudio&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-605"><a href="#cb115-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-606"><a href="#cb115-606" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-607"><a href="#cb115-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-608"><a href="#cb115-608" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Keenan EL, Odom KJ, Araya-Salas M, Horton KG, Strimas-Mackey M, Meatte MA, Mann NI, Slater PJ, Price JJ, and Templeton CN. 2020. <span class="co">[</span><span class="ot">**Breeding season length predicts duet coordination and consistency in Neotropical wrens (Troglodytidae)**</span><span class="co">](https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2020.2482)</span>. *Proceeding of the Royal Society B*. 20202482</span>
<span id="cb115-609"><a href="#cb115-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-610"><a href="#cb115-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-611"><a href="#cb115-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-612"><a href="#cb115-612" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/duets.png")</span></span>
<span id="cb115-613"><a href="#cb115-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-614"><a href="#cb115-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-615"><a href="#cb115-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-616"><a href="#cb115-616" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-617"><a href="#cb115-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-618"><a href="#cb115-618" aria-hidden="true" tabindex="-1"></a>"*... la coordinación y la consistencia de los duetos son mayores en las especies con temporadas de apareamiento especialmente largas.*"</span>
<span id="cb115-619"><a href="#cb115-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-620"><a href="#cb115-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "70%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-621"><a href="#cb115-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-622"><a href="#cb115-622" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/duet_reg.png")</span></span>
<span id="cb115-623"><a href="#cb115-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-624"><a href="#cb115-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-625"><a href="#cb115-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-626"><a href="#cb115-626" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-627"><a href="#cb115-627" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-628"><a href="#cb115-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-629"><a href="#cb115-629" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-630"><a href="#cb115-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-631"><a href="#cb115-631" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb115-632"><a href="#cb115-632" aria-hidden="true" tabindex="-1"></a>&lt;font size="5"&gt;Ejercicio 4&lt;/font&gt;</span>
<span id="cb115-633"><a href="#cb115-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-634"><a href="#cb115-634" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-635"><a href="#cb115-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-636"><a href="#cb115-636" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aumente el tamaño de la muestra (<span class="in">`n`</span>) a 1000 o más</span>
<span id="cb115-637"><a href="#cb115-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-638"><a href="#cb115-638" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>¿Cómo cambiaron los estimados del tamaño de efecto ($\beta$)?</span>
<span id="cb115-639"><a href="#cb115-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-640"><a href="#cb115-640" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>¿Cómo cambió los intervalos de confianza del tamaño de efecto?</span>
<span id="cb115-641"><a href="#cb115-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-642"><a href="#cb115-642" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ahora cambie <span class="in">`n`</span> a 15 y compruebe de nuevo las estimaciones del modelo (esta vez compruebe también el valor p)</span>
<span id="cb115-643"><a href="#cb115-643" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-644"><a href="#cb115-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-645"><a href="#cb115-645" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-646"><a href="#cb115-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-647"><a href="#cb115-647" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-648"><a href="#cb115-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-649"><a href="#cb115-649" aria-hidden="true" tabindex="-1"></a><span class="fu">## Varios predictores: regresión múltiple</span></span>
<span id="cb115-650"><a href="#cb115-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-651"><a href="#cb115-651" aria-hidden="true" tabindex="-1"></a>La regresión lineal múltiple es una extensión del modelo de regresión lineal simple que puede tomar varios predictores:</span>
<span id="cb115-652"><a href="#cb115-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-653"><a href="#cb115-653" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \cdots + \beta_{n} * x_{n}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-654"><a href="#cb115-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-655"><a href="#cb115-655" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-656"><a href="#cb115-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-657"><a href="#cb115-657" aria-hidden="true" tabindex="-1"></a>La fórmula parece compleja, pero sólo quiere decir que cualquier parámetro adicional tendrá su propia estimación ($\beta$). La fórmula para una regresión lineal de dos predictores se ve así:</span>
<span id="cb115-658"><a href="#cb115-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-659"><a href="#cb115-659" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-660"><a href="#cb115-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-661"><a href="#cb115-661" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-662"><a href="#cb115-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-663"><a href="#cb115-663" aria-hidden="true" tabindex="-1"></a>... y se puede simular así:</span>
<span id="cb115-664"><a href="#cb115-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-667"><a href="#cb115-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-668"><a href="#cb115-668" aria-hidden="true" tabindex="-1"></a><span class="co"># semila</span></span>
<span id="cb115-669"><a href="#cb115-669" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-670"><a href="#cb115-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-671"><a href="#cb115-671" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-672"><a href="#cb115-672" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-673"><a href="#cb115-673" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb115-674"><a href="#cb115-674" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb115-675"><a href="#cb115-675" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb115-676"><a href="#cb115-676" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb115-677"><a href="#cb115-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-678"><a href="#cb115-678" aria-hidden="true" tabindex="-1"></a><span class="co"># variables aleatorias</span></span>
<span id="cb115-679"><a href="#cb115-679" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-680"><a href="#cb115-680" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-681"><a href="#cb115-681" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb115-682"><a href="#cb115-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-683"><a href="#cb115-683" aria-hidden="true" tabindex="-1"></a><span class="co"># crear un data frame</span></span>
<span id="cb115-684"><a href="#cb115-684" aria-hidden="true" tabindex="-1"></a>xy_datos_multp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb115-685"><a href="#cb115-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-686"><a href="#cb115-686" aria-hidden="true" tabindex="-1"></a><span class="co"># construir el modelo</span></span>
<span id="cb115-687"><a href="#cb115-687" aria-hidden="true" tabindex="-1"></a>xy_mod_multp <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos_multp)</span>
<span id="cb115-688"><a href="#cb115-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-689"><a href="#cb115-689" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod_multp)</span>
<span id="cb115-690"><a href="#cb115-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-691"><a href="#cb115-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-692"><a href="#cb115-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-693"><a href="#cb115-693" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-694"><a href="#cb115-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-695"><a href="#cb115-695" aria-hidden="true" tabindex="-1"></a>... graficar los tamaños de efecto:</span>
<span id="cb115-696"><a href="#cb115-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-699"><a href="#cb115-699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-700"><a href="#cb115-700" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_multp<span class="sc">$</span>coefficients), </span>
<span id="cb115-701"><a href="#cb115-701" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod_multp<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_multp))</span>
<span id="cb115-702"><a href="#cb115-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-703"><a href="#cb115-703" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb115-704"><a href="#cb115-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-705"><a href="#cb115-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb115-706"><a href="#cb115-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb115-707"><a href="#cb115-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb115-708"><a href="#cb115-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-709"><a href="#cb115-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-710"><a href="#cb115-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-711"><a href="#cb115-711" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-712"><a href="#cb115-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-713"><a href="#cb115-713" aria-hidden="true" tabindex="-1"></a>... y los gráficos diagnósticos:</span>
<span id="cb115-714"><a href="#cb115-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-715"><a href="#cb115-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb115-716"><a href="#cb115-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-717"><a href="#cb115-717" aria-hidden="true" tabindex="-1"></a><span class="in">plot_model(xy_mod_multp, type = "diag")</span></span>
<span id="cb115-718"><a href="#cb115-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-719"><a href="#cb115-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-720"><a href="#cb115-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-721"><a href="#cb115-721" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-722"><a href="#cb115-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-723"><a href="#cb115-723" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb115-724"><a href="#cb115-724" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-725"><a href="#cb115-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-726"><a href="#cb115-726" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Interpretación del modelo&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-727"><a href="#cb115-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-728"><a href="#cb115-728" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-729"><a href="#cb115-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-730"><a href="#cb115-730" aria-hidden="true" tabindex="-1"></a>Cuadro con los coeficientes (estimados):</span>
<span id="cb115-731"><a href="#cb115-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-732"><a href="#cb115-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb115-733"><a href="#cb115-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-734"><a href="#cb115-734" aria-hidden="true" tabindex="-1"></a><span class="in">summ_xy_mod_multp &lt;- summary(xy_mod_multp)</span></span>
<span id="cb115-735"><a href="#cb115-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-736"><a href="#cb115-736" aria-hidden="true" tabindex="-1"></a><span class="in">summ_xy_mod_multp$coefficients</span></span>
<span id="cb115-737"><a href="#cb115-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-738"><a href="#cb115-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-739"><a href="#cb115-739" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo encontró que $\beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_xy_mod_multp$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod_multp$coefficients[2, 4]`</span>). Este es el efecto de 'x1' sobre 'y' una vez removida la variación explicada por 'x2'.</span>
<span id="cb115-740"><a href="#cb115-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-741"><a href="#cb115-741" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>También se encontró que el $\beta_2$ (el tamaño de efecto de 'x2') es <span class="in">`r summ_xy_mod_multp$coefficients[3, 1]`</span> y que también es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod_multp$coefficients[3, 4]`</span>). Este es el efecto de 'x2' sobre 'y' una vez removida la variación explicada por 'x1'.</span>
<span id="cb115-742"><a href="#cb115-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-743"><a href="#cb115-743" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lm()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb115-744"><a href="#cb115-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-745"><a href="#cb115-745" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_1$ se fijó en <span class="in">`r b1`</span> y se estimó como <span class="in">`r round(summ_xy_mod_multp$coefficients[2, 1], 3)`</span>.</span>
<span id="cb115-746"><a href="#cb115-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-747"><a href="#cb115-747" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_2$ (el tamaño de efecto de 'x2') se fijó en <span class="in">`r b2`</span> y se estimó como <span class="in">`r round(summ_xy_mod_multp$coefficients[3, 1], 3)`</span>.</span>
<span id="cb115-748"><a href="#cb115-748" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-749"><a href="#cb115-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-750"><a href="#cb115-750" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-751"><a href="#cb115-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-752"><a href="#cb115-752" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-753"><a href="#cb115-753" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Caso de estudio&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-754"><a href="#cb115-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-755"><a href="#cb115-755" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-756"><a href="#cb115-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-757"><a href="#cb115-757" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Araya-Salas M, P González-Gómez, K Wojczulanis-Jakubas, V López III &amp; T Wright. 2018. <span class="co">[</span><span class="ot">**Spatial memory is as important as weapon and body size for territorial ownership in a lekking hummingbird**</span><span class="co">](https://www.nature.com/articles/s41598-018-20441-x)</span>. *Scientific Reports*. 13, e0189969</span>
<span id="cb115-758"><a href="#cb115-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-759"><a href="#cb115-759" aria-hidden="true" tabindex="-1"></a>"*La memoria espacial, el tamaño corporal y el largo de la punta del pico ... predijeron positivamente la probabilidad de adquirir y defender un territorio.*"</span>
<span id="cb115-760"><a href="#cb115-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-761"><a href="#cb115-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-762"><a href="#cb115-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-763"><a href="#cb115-763" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/lbh_cognition.png")</span></span>
<span id="cb115-764"><a href="#cb115-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-765"><a href="#cb115-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-766"><a href="#cb115-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-767"><a href="#cb115-767" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-768"><a href="#cb115-768" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-769"><a href="#cb115-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-770"><a href="#cb115-770" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-771"><a href="#cb115-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-772"><a href="#cb115-772" aria-hidden="true" tabindex="-1"></a>Hay un punto importante que es necesario enfatizar aquí: **la regresión múltiple estima el efecto de un predictor después de tener en cuenta el efecto de los demás predictores del modelo**. En otras palabras, los nuevos predictores del modelo tratarán de explicar la variación de los datos que no fue explicada por los otros predictores. Así que **el resultado de la regresión múltiple no es equivalente a los resultados de las regresiones lineales simples** sobre los mismos predictores. Esto puede demostrarse fácilmente corriendo esas regresiones:</span>
<span id="cb115-773"><a href="#cb115-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-776"><a href="#cb115-776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-777"><a href="#cb115-777" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos</span></span>
<span id="cb115-778"><a href="#cb115-778" aria-hidden="true" tabindex="-1"></a>x1y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb115-779"><a href="#cb115-779" aria-hidden="true" tabindex="-1"></a>x2y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb115-780"><a href="#cb115-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-781"><a href="#cb115-781" aria-hidden="true" tabindex="-1"></a><span class="co"># atajo a los coeficientes</span></span>
<span id="cb115-782"><a href="#cb115-782" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(xy_mod)</span>
<span id="cb115-783"><a href="#cb115-783" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(x1y_mod)</span>
<span id="cb115-784"><a href="#cb115-784" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(x2y_mod)</span>
<span id="cb115-785"><a href="#cb115-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-786"><a href="#cb115-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-787"><a href="#cb115-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-788"><a href="#cb115-788" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-789"><a href="#cb115-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-790"><a href="#cb115-790" aria-hidden="true" tabindex="-1"></a>Las estimaciones de las mismas variables varían considerablemente entre la regresión múltiple y las regresiones de un solo predictor.</span>
<span id="cb115-791"><a href="#cb115-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-792"><a href="#cb115-792" aria-hidden="true" tabindex="-1"></a>Este punto se demuestra además por el hecho de que, si uno de los predictores no tiene ninguna influencia en la respuesta, el efecto del predictor adicional convergerá a su efecto en una regresión lineal simple. Para simular este escenario, fijamos b2 en 0:</span>
<span id="cb115-793"><a href="#cb115-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-796"><a href="#cb115-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-797"><a href="#cb115-797" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-798"><a href="#cb115-798" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-799"><a href="#cb115-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-800"><a href="#cb115-800" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-801"><a href="#cb115-801" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-802"><a href="#cb115-802" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb115-803"><a href="#cb115-803" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb115-804"><a href="#cb115-804" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb115-805"><a href="#cb115-805" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-806"><a href="#cb115-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-807"><a href="#cb115-807" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb115-808"><a href="#cb115-808" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-809"><a href="#cb115-809" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-810"><a href="#cb115-810" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb115-811"><a href="#cb115-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-812"><a href="#cb115-812" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb115-813"><a href="#cb115-813" aria-hidden="true" tabindex="-1"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb115-814"><a href="#cb115-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-815"><a href="#cb115-815" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos</span></span>
<span id="cb115-816"><a href="#cb115-816" aria-hidden="true" tabindex="-1"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb115-817"><a href="#cb115-817" aria-hidden="true" tabindex="-1"></a>x1y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb115-818"><a href="#cb115-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-819"><a href="#cb115-819" aria-hidden="true" tabindex="-1"></a><span class="co"># shortcut to coefficients</span></span>
<span id="cb115-820"><a href="#cb115-820" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(xy_mod)</span>
<span id="cb115-821"><a href="#cb115-821" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(x1y_mod)</span>
<span id="cb115-822"><a href="#cb115-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-823"><a href="#cb115-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-824"><a href="#cb115-824" aria-hidden="true" tabindex="-1"></a>El estimado de $\beta_1$ fue casi el mismo en la regresión múltiple (<span class="in">`r coef(xy_mod)[2]`</span>) y en la regresión de un solo predictor (<span class="in">`r coef(x1y_mod)[2]`</span>)</span>
<span id="cb115-825"><a href="#cb115-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-826"><a href="#cb115-826" aria-hidden="true" tabindex="-1"></a>Por comodidad, hemos utilizado <span class="in">`coef()`</span> para extraer sólo los estimado de la regresión, pero los valores son los mismos que obtenemos con <span class="in">`summary(model)`</span>.</span>
<span id="cb115-827"><a href="#cb115-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-828"><a href="#cb115-828" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-829"><a href="#cb115-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-830"><a href="#cb115-830" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb115-831"><a href="#cb115-831" aria-hidden="true" tabindex="-1"></a>&lt;font size="5"&gt;Ejercicio 5&lt;/font&gt;</span>
<span id="cb115-832"><a href="#cb115-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-833"><a href="#cb115-833" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-834"><a href="#cb115-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-835"><a href="#cb115-835" aria-hidden="true" tabindex="-1"></a>La siguiente simulación genera un par de predictores continuos altamente colineales:</span>
<span id="cb115-836"><a href="#cb115-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-839"><a href="#cb115-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-840"><a href="#cb115-840" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-841"><a href="#cb115-841" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-842"><a href="#cb115-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-843"><a href="#cb115-843" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-844"><a href="#cb115-844" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb115-845"><a href="#cb115-845" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb115-846"><a href="#cb115-846" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb115-847"><a href="#cb115-847" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb115-848"><a href="#cb115-848" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-849"><a href="#cb115-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-850"><a href="#cb115-850" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias colineales</span></span>
<span id="cb115-851"><a href="#cb115-851" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-852"><a href="#cb115-852" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span>  x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.2</span>) <span class="co"># hacer x2 colineal con x1</span></span>
<span id="cb115-853"><a href="#cb115-853" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb115-854"><a href="#cb115-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-855"><a href="#cb115-855" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb115-856"><a href="#cb115-856" aria-hidden="true" tabindex="-1"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb115-857"><a href="#cb115-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-858"><a href="#cb115-858" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x1, x2)</span>
<span id="cb115-859"><a href="#cb115-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-860"><a href="#cb115-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-861"><a href="#cb115-861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb115-862"><a href="#cb115-862" aria-hidden="true" tabindex="-1"></a><span class="in"># graficar</span></span>
<span id="cb115-863"><a href="#cb115-863" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = xy_datos, aes(x = x1, y = x2)) +</span></span>
<span id="cb115-864"><a href="#cb115-864" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(size = 3)</span></span>
<span id="cb115-865"><a href="#cb115-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-866"><a href="#cb115-866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-867"><a href="#cb115-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-868"><a href="#cb115-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb115-869"><a href="#cb115-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-870"><a href="#cb115-870" aria-hidden="true" tabindex="-1"></a><span class="in"># graficar</span></span>
<span id="cb115-871"><a href="#cb115-871" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = xy_datos, aes(x = x1, y = x2)) +</span></span>
<span id="cb115-872"><a href="#cb115-872" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(size = 3) +</span></span>
<span id="cb115-873"><a href="#cb115-873" aria-hidden="true" tabindex="-1"></a><span class="in">theme(panel.background = element_rect(fill = fill$alert), plot.background = element_rect(fill = fill$alert, colour=NA))</span></span>
<span id="cb115-874"><a href="#cb115-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-875"><a href="#cb115-875" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-876"><a href="#cb115-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-877"><a href="#cb115-877" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Construya un modelo lineal multiple (con <span class="in">`lm()`</span>) con 'y' como respuesta y 'x1' y 'x2' como predictores</span>
<span id="cb115-878"><a href="#cb115-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-879"><a href="#cb115-879" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Compare los betas estimados por el modelo con los usados para generar los datos. ¿Es una buena estimación?. También observe los valores de p. ¿Esperaría que fueran significativos?</span>
<span id="cb115-880"><a href="#cb115-880" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-881"><a href="#cb115-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-882"><a href="#cb115-882" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-883"><a href="#cb115-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-884"><a href="#cb115-884" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-885"><a href="#cb115-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-886"><a href="#cb115-886" aria-hidden="true" tabindex="-1"></a><span class="fu">## Añadir un predictor categórico</span></span>
<span id="cb115-887"><a href="#cb115-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-888"><a href="#cb115-888" aria-hidden="true" tabindex="-1"></a>Para los predictores categóricos podemos crear primero una variable binaria (0, 1) y luego añadir etiquetas a cada valor:</span>
<span id="cb115-889"><a href="#cb115-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-892"><a href="#cb115-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-893"><a href="#cb115-893" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-894"><a href="#cb115-894" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb115-895"><a href="#cb115-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-896"><a href="#cb115-896" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-897"><a href="#cb115-897" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-898"><a href="#cb115-898" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb115-899"><a href="#cb115-899" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb115-900"><a href="#cb115-900" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb115-901"><a href="#cb115-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-902"><a href="#cb115-902" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb115-903"><a href="#cb115-903" aria-hidden="true" tabindex="-1"></a>x1_num <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb115-904"><a href="#cb115-904" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1_num <span class="sc">+</span> error</span>
<span id="cb115-905"><a href="#cb115-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-906"><a href="#cb115-906" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1_num, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb115-907"><a href="#cb115-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-908"><a href="#cb115-908" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb115-909"><a href="#cb115-909" aria-hidden="true" tabindex="-1"></a>xy_datos_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x1_num, y)</span>
<span id="cb115-910"><a href="#cb115-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-911"><a href="#cb115-911" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_cat)</span>
<span id="cb115-912"><a href="#cb115-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-913"><a href="#cb115-913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-914"><a href="#cb115-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-915"><a href="#cb115-915" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-916"><a href="#cb115-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-917"><a href="#cb115-917" aria-hidden="true" tabindex="-1"></a>Y así es como se escribe formalmente:</span>
<span id="cb115-918"><a href="#cb115-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-919"><a href="#cb115-919" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-920"><a href="#cb115-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-921"><a href="#cb115-921" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-922"><a href="#cb115-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-923"><a href="#cb115-923" aria-hidden="true" tabindex="-1"></a>Lo mismo que con los predictores continuos.</span>
<span id="cb115-924"><a href="#cb115-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-925"><a href="#cb115-925" aria-hidden="true" tabindex="-1"></a>Podemos explorar el patrón de los datos utilizando un diagrama de cajas (boxplot):</span>
<span id="cb115-926"><a href="#cb115-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-929"><a href="#cb115-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-930"><a href="#cb115-930" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb115-931"><a href="#cb115-931" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb115-932"><a href="#cb115-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb115-933"><a href="#cb115-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-934"><a href="#cb115-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-935"><a href="#cb115-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-936"><a href="#cb115-936" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-937"><a href="#cb115-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-938"><a href="#cb115-938" aria-hidden="true" tabindex="-1"></a>... y obtener los estimados del modelo:</span>
<span id="cb115-939"><a href="#cb115-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-942"><a href="#cb115-942" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-943"><a href="#cb115-943" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos</span></span>
<span id="cb115-944"><a href="#cb115-944" aria-hidden="true" tabindex="-1"></a>xy_mod_cat <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos_cat)</span>
<span id="cb115-945"><a href="#cb115-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-946"><a href="#cb115-946" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod_cat)</span>
<span id="cb115-947"><a href="#cb115-947" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-948"><a href="#cb115-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-949"><a href="#cb115-949" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-950"><a href="#cb115-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-951"><a href="#cb115-951" aria-hidden="true" tabindex="-1"></a>... graficar los tamaños de efecto:</span>
<span id="cb115-952"><a href="#cb115-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-955"><a href="#cb115-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-956"><a href="#cb115-956" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_cat<span class="sc">$</span>coefficients), </span>
<span id="cb115-957"><a href="#cb115-957" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod_cat<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_cat))</span>
<span id="cb115-958"><a href="#cb115-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-959"><a href="#cb115-959" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb115-960"><a href="#cb115-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-961"><a href="#cb115-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb115-962"><a href="#cb115-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb115-963"><a href="#cb115-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb115-964"><a href="#cb115-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-965"><a href="#cb115-965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-966"><a href="#cb115-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-967"><a href="#cb115-967" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-968"><a href="#cb115-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-969"><a href="#cb115-969" aria-hidden="true" tabindex="-1"></a>... y los gráficos diagnósticos del modelo:</span>
<span id="cb115-970"><a href="#cb115-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-971"><a href="#cb115-971" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb115-972"><a href="#cb115-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-973"><a href="#cb115-973" aria-hidden="true" tabindex="-1"></a><span class="in">plot_model(xy_mod_cat, type = "diag")[[2]]</span></span>
<span id="cb115-974"><a href="#cb115-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-975"><a href="#cb115-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-976"><a href="#cb115-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-977"><a href="#cb115-977" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-978"><a href="#cb115-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-979"><a href="#cb115-979" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb115-980"><a href="#cb115-980" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-981"><a href="#cb115-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-982"><a href="#cb115-982" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Interpretación del modelo&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-983"><a href="#cb115-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-984"><a href="#cb115-984" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-985"><a href="#cb115-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-986"><a href="#cb115-986" aria-hidden="true" tabindex="-1"></a>Cuadro con los coeficientes (estimados):</span>
<span id="cb115-987"><a href="#cb115-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-988"><a href="#cb115-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb115-989"><a href="#cb115-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-990"><a href="#cb115-990" aria-hidden="true" tabindex="-1"></a><span class="in">summ_xy_mod_cat &lt;- summary(xy_mod_cat)</span></span>
<span id="cb115-991"><a href="#cb115-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-992"><a href="#cb115-992" aria-hidden="true" tabindex="-1"></a><span class="in">summ_xy_mod_cat$coefficients</span></span>
<span id="cb115-993"><a href="#cb115-993" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-994"><a href="#cb115-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-995"><a href="#cb115-995" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo encontró que $\beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_xy_mod_cat$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod_cat$coefficients[2, 4]`</span>)</span>
<span id="cb115-996"><a href="#cb115-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-997"><a href="#cb115-997" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lm()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb115-998"><a href="#cb115-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-999"><a href="#cb115-999" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_1$ se fijó en <span class="in">`r b1`</span> y se estimó como <span class="in">`r round(summ_xy_mod_cat$coefficients[2, 1], 3)`</span>.</span>
<span id="cb115-1000"><a href="#cb115-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1001"><a href="#cb115-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tenga en cuenta que en este caso el intercepto se refiere a la estimación del nivel 'a' en el predictor categórico, que se utilizó como base:</span>
<span id="cb115-1002"><a href="#cb115-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1003"><a href="#cb115-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb115-1004"><a href="#cb115-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1005"><a href="#cb115-1005" aria-hidden="true" tabindex="-1"></a><span class="in"># graficar</span></span>
<span id="cb115-1006"><a href="#cb115-1006" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(xy_datos_cat, aes(x = x1, y = y)) + </span></span>
<span id="cb115-1007"><a href="#cb115-1007" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot() +</span></span>
<span id="cb115-1008"><a href="#cb115-1008" aria-hidden="true" tabindex="-1"></a><span class="in">geom_hline(yintercept = xy_mod_cat$coefficients[1], col = "blue")</span></span>
<span id="cb115-1009"><a href="#cb115-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1010"><a href="#cb115-1010" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1011"><a href="#cb115-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1012"><a href="#cb115-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb115-1013"><a href="#cb115-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1014"><a href="#cb115-1014" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(xy_datos_cat, aes(x = x1, y = y)) + </span></span>
<span id="cb115-1015"><a href="#cb115-1015" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot() + </span></span>
<span id="cb115-1016"><a href="#cb115-1016" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = xy_mod_cat$coefficients[1], col = "blue") +</span></span>
<span id="cb115-1017"><a href="#cb115-1017" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.background = element_rect(fill = fill$success), plot.background = element_rect(fill = fill$success, colour=NA))</span></span>
<span id="cb115-1018"><a href="#cb115-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1019"><a href="#cb115-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1020"><a href="#cb115-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1021"><a href="#cb115-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Por lo tanto, el intercepto es el mismo que la media de *y* para la categoría 'a':</span>
<span id="cb115-1022"><a href="#cb115-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1025"><a href="#cb115-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1026"><a href="#cb115-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xy_datos_cat<span class="sc">$</span>y[xy_datos_cat<span class="sc">$</span>x1 <span class="sc">==</span> <span class="st">"a"</span>])</span>
<span id="cb115-1027"><a href="#cb115-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1028"><a href="#cb115-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1029"><a href="#cb115-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1030"><a href="#cb115-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Observe también que la etiqueta del estimado es 'x1b', no 'x1' como en los predictores continuos. Esto se debe a que en este caso el estimado se refiere a la diferencia entre los dos niveles de la variable categórica ('a' y 'b'). Más concretamente, nos dice que en promedio las observaciones de la categoría 'b' son <span class="in">`r round(summ_xy_mod_cat$coefficients[2, 1], 3)`</span> más altas que las observaciones de la categoría 'a'.</span>
<span id="cb115-1031"><a href="#cb115-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1032"><a href="#cb115-1032" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1033"><a href="#cb115-1033" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1034"><a href="#cb115-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1035"><a href="#cb115-1035" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1036"><a href="#cb115-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1037"><a href="#cb115-1037" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-1038"><a href="#cb115-1038" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Caso de estudio&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1039"><a href="#cb115-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1040"><a href="#cb115-1040" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1041"><a href="#cb115-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1042"><a href="#cb115-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rico-Guevara A, &amp; M Araya-Salas. 2015. <span class="co">[</span><span class="ot">**Bills as daggers? A test for sexually dimorphic weapons in a lekking hummingbird species**</span><span class="co">](https://academic.oup.com/beheco/article/26/1/21/2262689)</span>. *Behavioral Ecology*. 26 (1): 21-29.</span>
<span id="cb115-1043"><a href="#cb115-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1044"><a href="#cb115-1044" aria-hidden="true" tabindex="-1"></a>"*Los machos con puntas de pico más grandes y puntiagudas tuvieron más éxito en ganar control de territorios en el lek.*"</span>
<span id="cb115-1045"><a href="#cb115-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1046"><a href="#cb115-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "75%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-1047"><a href="#cb115-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1048"><a href="#cb115-1048" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/daggers_lbh.png")</span></span>
<span id="cb115-1049"><a href="#cb115-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1050"><a href="#cb115-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1051"><a href="#cb115-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1052"><a href="#cb115-1052" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1053"><a href="#cb115-1053" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1054"><a href="#cb115-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1055"><a href="#cb115-1055" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1056"><a href="#cb115-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1057"><a href="#cb115-1057" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb115-1058"><a href="#cb115-1058" aria-hidden="true" tabindex="-1"></a>&lt;font size="5"&gt;Ejercicio 6&lt;/font&gt;</span>
<span id="cb115-1059"><a href="#cb115-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1060"><a href="#cb115-1060" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1061"><a href="#cb115-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1062"><a href="#cb115-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Los datos desbalanceados cuando hay categorías (es decir, algunas categorías tienen muchas más observaciones que otras) pueden ser problemáticos para la inferencia estadística. Modifique el código arriba para simular un juego de datos muy desbalanceado y compruebe la precisión del modelo.</span>
<span id="cb115-1063"><a href="#cb115-1063" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1064"><a href="#cb115-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1065"><a href="#cb115-1065" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-1066"><a href="#cb115-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1067"><a href="#cb115-1067" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-1068"><a href="#cb115-1068" aria-hidden="true" tabindex="-1"></a>&lt;font size = 6&gt;</span>
<span id="cb115-1069"><a href="#cb115-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1070"><a href="#cb115-1070" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;Variables indicadoras (Dummy variables)&lt;/center&gt;</span>
<span id="cb115-1071"><a href="#cb115-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1072"><a href="#cb115-1072" aria-hidden="true" tabindex="-1"></a>&lt;/font&gt;</span>
<span id="cb115-1073"><a href="#cb115-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1074"><a href="#cb115-1074" aria-hidden="true" tabindex="-1"></a>En un modelo de regresión, los predictores categóricos también se representan como vectores numéricos. Más concretamente, los predictores categóricos se codifican como 0s y 1s, en los que 1 significa "pertenece a la misma categoría" y 0 "pertenece a una categoría diferente". Mantuvimos el vector numérico original ('x1_num') al simular el juego de datos con el predictor categórico:</span>
<span id="cb115-1075"><a href="#cb115-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1078"><a href="#cb115-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1079"><a href="#cb115-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_cat)</span>
<span id="cb115-1080"><a href="#cb115-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1081"><a href="#cb115-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1082"><a href="#cb115-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1083"><a href="#cb115-1083" aria-hidden="true" tabindex="-1"></a>Observe que las "b" de la columna "x1" se convierten en 1 en la columna "x1_num" y las "a" se convierten en 0. Esto se denomina variable indicadora y el proceso se conoce como 'codificación indicadora' (dummy coding).</span>
<span id="cb115-1084"><a href="#cb115-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1085"><a href="#cb115-1085" aria-hidden="true" tabindex="-1"></a>En realidad, podemos utilizar el vector numérico en el modelo de regresión y obtener exactamente los mismos resultados:</span>
<span id="cb115-1086"><a href="#cb115-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1089"><a href="#cb115-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1090"><a href="#cb115-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># summary model with categorical variable</span></span>
<span id="cb115-1091"><a href="#cb115-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod_cat)<span class="sc">$</span>coefficients</span>
<span id="cb115-1092"><a href="#cb115-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1093"><a href="#cb115-1093" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos with dummy variable</span></span>
<span id="cb115-1094"><a href="#cb115-1094" aria-hidden="true" tabindex="-1"></a>xy_mod_num <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1_num, <span class="at">data =</span> xy_datos_cat)</span>
<span id="cb115-1095"><a href="#cb115-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1096"><a href="#cb115-1096" aria-hidden="true" tabindex="-1"></a><span class="co"># summary with dummy coding</span></span>
<span id="cb115-1097"><a href="#cb115-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(xy_mod_num)<span class="sc">$</span>coefficients</span>
<span id="cb115-1098"><a href="#cb115-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1099"><a href="#cb115-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1100"><a href="#cb115-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1101"><a href="#cb115-1101" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1102"><a href="#cb115-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1103"><a href="#cb115-1103" aria-hidden="true" tabindex="-1"></a>Las cosas se complican un poco más cuando se codifica un predictor categórico con más de dos niveles. Pero la lógica es la misma.</span>
<span id="cb115-1104"><a href="#cb115-1104" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1105"><a href="#cb115-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1106"><a href="#cb115-1106" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1107"><a href="#cb115-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1108"><a href="#cb115-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb115-1109"><a href="#cb115-1109" aria-hidden="true" tabindex="-1"></a><span class="in">This approach can be extended to simulate categorical variables with more than 2 levels:</span></span>
<span id="cb115-1110"><a href="#cb115-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1111"><a href="#cb115-1111" aria-hidden="true" tabindex="-1"></a><span class="in"># definir semilla</span></span>
<span id="cb115-1112"><a href="#cb115-1112" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)</span></span>
<span id="cb115-1113"><a href="#cb115-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1114"><a href="#cb115-1114" aria-hidden="true" tabindex="-1"></a><span class="in"># numero de observaciones</span></span>
<span id="cb115-1115"><a href="#cb115-1115" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 50</span></span>
<span id="cb115-1116"><a href="#cb115-1116" aria-hidden="true" tabindex="-1"></a><span class="in">b0 &lt;- -4</span></span>
<span id="cb115-1117"><a href="#cb115-1117" aria-hidden="true" tabindex="-1"></a><span class="in">b1 &lt;- 3</span></span>
<span id="cb115-1118"><a href="#cb115-1118" aria-hidden="true" tabindex="-1"></a><span class="in">error &lt;- rnorm(n = n, mean = 0, sd = 1)</span></span>
<span id="cb115-1119"><a href="#cb115-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1120"><a href="#cb115-1120" aria-hidden="true" tabindex="-1"></a><span class="in">#  variables aleatorias</span></span>
<span id="cb115-1121"><a href="#cb115-1121" aria-hidden="true" tabindex="-1"></a><span class="in">x1 &lt;- rbinom(n = n, size = 2, prob = c(0.33, 0.33))</span></span>
<span id="cb115-1122"><a href="#cb115-1122" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- b0 + b1 * x1 + error</span></span>
<span id="cb115-1123"><a href="#cb115-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1124"><a href="#cb115-1124" aria-hidden="true" tabindex="-1"></a><span class="in">x1 &lt;- factor(x1, labels = c("a", "b", "c"))</span></span>
<span id="cb115-1125"><a href="#cb115-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1126"><a href="#cb115-1126" aria-hidden="true" tabindex="-1"></a><span class="in"># crear data frame</span></span>
<span id="cb115-1127"><a href="#cb115-1127" aria-hidden="true" tabindex="-1"></a><span class="in">xy_datos &lt;- data.frame(x1, y)</span></span>
<span id="cb115-1128"><a href="#cb115-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1129"><a href="#cb115-1129" aria-hidden="true" tabindex="-1"></a><span class="in"># boxplot(formula = y ~ x1, data = xy_datos)</span></span>
<span id="cb115-1130"><a href="#cb115-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1131"><a href="#cb115-1131" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(xy_datos, aes(x = x1, y = y)) + </span></span>
<span id="cb115-1132"><a href="#cb115-1132" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot() +</span></span>
<span id="cb115-1133"><a href="#cb115-1133" aria-hidden="true" tabindex="-1"></a><span class="in">geom_hline(yintercept = xy_mod$coefficients[1], col = "blue")</span></span>
<span id="cb115-1134"><a href="#cb115-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1135"><a href="#cb115-1135" aria-hidden="true" tabindex="-1"></a><span class="in">&amp;nbsp;</span></span>
<span id="cb115-1136"><a href="#cb115-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1137"><a href="#cb115-1137" aria-hidden="true" tabindex="-1"></a><span class="in">And these are the results:</span></span>
<span id="cb115-1138"><a href="#cb115-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1139"><a href="#cb115-1139" aria-hidden="true" tabindex="-1"></a><span class="in"># construir modelos</span></span>
<span id="cb115-1140"><a href="#cb115-1140" aria-hidden="true" tabindex="-1"></a><span class="in">xy_mod &lt;- lm(formula = y ~ x1, data = xy_datos)</span></span>
<span id="cb115-1141"><a href="#cb115-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1142"><a href="#cb115-1142" aria-hidden="true" tabindex="-1"></a><span class="in">summary(xy_mod)</span></span>
<span id="cb115-1143"><a href="#cb115-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1144"><a href="#cb115-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1145"><a href="#cb115-1145" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-1146"><a href="#cb115-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1147"><a href="#cb115-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interacciones</span></span>
<span id="cb115-1148"><a href="#cb115-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1149"><a href="#cb115-1149" aria-hidden="true" tabindex="-1"></a>Una interacción estadística se refiere a un efecto de una variable predictora que está mediado por una segunda variable.</span>
<span id="cb115-1150"><a href="#cb115-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1151"><a href="#cb115-1151" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2} + \beta_{3} * x_{1} * x_{2}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1152"><a href="#cb115-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1153"><a href="#cb115-1153" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1154"><a href="#cb115-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1155"><a href="#cb115-1155" aria-hidden="true" tabindex="-1"></a>Esto es más fácil de entender si se observa la interacción de una variable continua y una binaria:</span>
<span id="cb115-1156"><a href="#cb115-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1159"><a href="#cb115-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1160"><a href="#cb115-1160" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-1161"><a href="#cb115-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-1162"><a href="#cb115-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1163"><a href="#cb115-1163" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-1164"><a href="#cb115-1164" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-1165"><a href="#cb115-1165" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb115-1166"><a href="#cb115-1166" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb115-1167"><a href="#cb115-1167" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fl">1.7</span></span>
<span id="cb115-1168"><a href="#cb115-1168" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb115-1169"><a href="#cb115-1169" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb115-1170"><a href="#cb115-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1171"><a href="#cb115-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb115-1172"><a href="#cb115-1172" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb115-1173"><a href="#cb115-1173" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-1174"><a href="#cb115-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1175"><a href="#cb115-1175" aria-hidden="true" tabindex="-1"></a><span class="co"># interaccion se añade como el producto dex1 y x2</span></span>
<span id="cb115-1176"><a href="#cb115-1176" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> b3 <span class="sc">*</span> x1 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb115-1177"><a href="#cb115-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1178"><a href="#cb115-1178" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb115-1179"><a href="#cb115-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1180"><a href="#cb115-1180" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb115-1181"><a href="#cb115-1181" aria-hidden="true" tabindex="-1"></a>xy_datos_intr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb115-1182"><a href="#cb115-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1183"><a href="#cb115-1183" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_intr)</span>
<span id="cb115-1184"><a href="#cb115-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1185"><a href="#cb115-1185" aria-hidden="true" tabindex="-1"></a><span class="co"># construir modelos</span></span>
<span id="cb115-1186"><a href="#cb115-1186" aria-hidden="true" tabindex="-1"></a>xy_mod_intr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x1 <span class="sc">*</span> x2, <span class="at">data =</span> xy_datos_intr)</span>
<span id="cb115-1187"><a href="#cb115-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1188"><a href="#cb115-1188" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar resumen para graficar lineas de mejor ajuste</span></span>
<span id="cb115-1189"><a href="#cb115-1189" aria-hidden="true" tabindex="-1"></a>xy_summ_intr <span class="ot">&lt;-</span> <span class="fu">summary</span>(xy_mod_intr)</span>
<span id="cb115-1190"><a href="#cb115-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1191"><a href="#cb115-1191" aria-hidden="true" tabindex="-1"></a>xy_summ_intr</span>
<span id="cb115-1192"><a href="#cb115-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1193"><a href="#cb115-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1194"><a href="#cb115-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1195"><a href="#cb115-1195" aria-hidden="true" tabindex="-1"></a>También ayuda graficar los datos:</span>
<span id="cb115-1196"><a href="#cb115-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1197"><a href="#cb115-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb115-1198"><a href="#cb115-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1199"><a href="#cb115-1199" aria-hidden="true" tabindex="-1"></a><span class="in"># graficar</span></span>
<span id="cb115-1200"><a href="#cb115-1200" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = xy_datos_intr, aes(x = x2, y = y, color = x1)) +</span></span>
<span id="cb115-1201"><a href="#cb115-1201" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(size = 3) +</span></span>
<span id="cb115-1202"><a href="#cb115-1202" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_smooth(method = "lm", se = FALSE)</span></span>
<span id="cb115-1203"><a href="#cb115-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1204"><a href="#cb115-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1205"><a href="#cb115-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1206"><a href="#cb115-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE, out.width = "80%"}</span></span>
<span id="cb115-1207"><a href="#cb115-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1208"><a href="#cb115-1208" aria-hidden="true" tabindex="-1"></a><span class="in"># graficar</span></span>
<span id="cb115-1209"><a href="#cb115-1209" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = xy_datos_intr, aes(x = x2, y = y, color = x1)) +</span></span>
<span id="cb115-1210"><a href="#cb115-1210" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(size = 3) + scale_color_viridis_d(end = 0.9, begin = 0.2, alpha = 0.6) +</span></span>
<span id="cb115-1211"><a href="#cb115-1211" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot2::geom_smooth(method = "lm", se = FALSE)</span></span>
<span id="cb115-1212"><a href="#cb115-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1213"><a href="#cb115-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1214"><a href="#cb115-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1215"><a href="#cb115-1215" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1216"><a href="#cb115-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1217"><a href="#cb115-1217" aria-hidden="true" tabindex="-1"></a>... y los tamaños de efecto:</span>
<span id="cb115-1218"><a href="#cb115-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1221"><a href="#cb115-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1222"><a href="#cb115-1222" aria-hidden="true" tabindex="-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_intr<span class="sc">$</span>coefficients), </span>
<span id="cb115-1223"><a href="#cb115-1223" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est =</span> xy_mod_intr<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_intr))</span>
<span id="cb115-1224"><a href="#cb115-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1225"><a href="#cb115-1225" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb115-1226"><a href="#cb115-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-1227"><a href="#cb115-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb115-1228"><a href="#cb115-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb115-1229"><a href="#cb115-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb115-1230"><a href="#cb115-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1231"><a href="#cb115-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1232"><a href="#cb115-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1233"><a href="#cb115-1233" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1234"><a href="#cb115-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1235"><a href="#cb115-1235" aria-hidden="true" tabindex="-1"></a>También deberíamos revisar los gráficos de diagnóstico:</span>
<span id="cb115-1236"><a href="#cb115-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1237"><a href="#cb115-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb115-1238"><a href="#cb115-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1239"><a href="#cb115-1239" aria-hidden="true" tabindex="-1"></a><span class="in">plot_model(xy_mod_intr, type = "diag")</span></span>
<span id="cb115-1240"><a href="#cb115-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1241"><a href="#cb115-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1242"><a href="#cb115-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1243"><a href="#cb115-1243" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1244"><a href="#cb115-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1245"><a href="#cb115-1245" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb115-1246"><a href="#cb115-1246" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1247"><a href="#cb115-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1248"><a href="#cb115-1248" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Interpretación del modelo&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1249"><a href="#cb115-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1250"><a href="#cb115-1250" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1251"><a href="#cb115-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1252"><a href="#cb115-1252" aria-hidden="true" tabindex="-1"></a>Cuadro con los coeficientes:</span>
<span id="cb115-1253"><a href="#cb115-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1254"><a href="#cb115-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb115-1255"><a href="#cb115-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1256"><a href="#cb115-1256" aria-hidden="true" tabindex="-1"></a><span class="in">xy_summ_intr$coefficients</span></span>
<span id="cb115-1257"><a href="#cb115-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1258"><a href="#cb115-1258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1259"><a href="#cb115-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1260"><a href="#cb115-1260" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo encontró que $\beta_1$ (el tamaño de efecto de 'x1-b' a 'x1-a') es <span class="in">`r xy_summ_intr$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (valor p = <span class="in">`r xy_summ_intr$coefficients[2, 4]`</span>)</span>
<span id="cb115-1261"><a href="#cb115-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1262"><a href="#cb115-1262" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo encontró que $\beta_2$ (el tamaño de efecto de 'x2') es <span class="in">`r xy_summ_intr$coefficients[3, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r xy_summ_intr$coefficients[3, 4]`</span>). Esto es en realidad la pendiente de la relación entre x2 e y cuando x1 = <span class="sc">\`</span>a'</span>
<span id="cb115-1263"><a href="#cb115-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1264"><a href="#cb115-1264" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo encontró que $\beta_3$ (el tamaño de efecto del término de interacción 'x1 <span class="sc">\*</span> x2') es <span class="in">`r xy_summ_intr$coefficients[4, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r xy_summ_intr$coefficients[4, 4]`</span>). Esta es la diferencia entre las pendientes de x2 *vs* y cuando x1 = 'a' y x2 *vs* y cuando x1 = 'b'.</span>
<span id="cb115-1265"><a href="#cb115-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1266"><a href="#cb115-1266" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Los valores simulados para los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lm()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb115-1267"><a href="#cb115-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1268"><a href="#cb115-1268" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_1$ se simuló con un valor de <span class="in">`r b1`</span> y se estimó en <span class="in">`r round(xy_summ_intr$coefficients[2, 1], 3)`</span></span>
<span id="cb115-1269"><a href="#cb115-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1270"><a href="#cb115-1270" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_2$ se simuló con un valor de <span class="in">`r b2`</span> y se estimó en <span class="in">`r round(xy_summ_intr$coefficients[3, 1], 3)`</span></span>
<span id="cb115-1271"><a href="#cb115-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1272"><a href="#cb115-1272" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_3$ se simuló con un valor de <span class="in">`r b3`</span> y se estimó en <span class="in">`r round(xy_summ_intr$coefficients[4, 1], 3)`</span></span>
<span id="cb115-1273"><a href="#cb115-1273" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1274"><a href="#cb115-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1275"><a href="#cb115-1275" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-1276"><a href="#cb115-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1277"><a href="#cb115-1277" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1278"><a href="#cb115-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1279"><a href="#cb115-1279" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-1280"><a href="#cb115-1280" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Caso de estudio&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1281"><a href="#cb115-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1282"><a href="#cb115-1282" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1283"><a href="#cb115-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1284"><a href="#cb115-1284" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chirino F, B Wilink, Araya-Salas M. In prep. **Climatic factors affecting vocal activity in lemur leaf frogs**.</span>
<span id="cb115-1285"><a href="#cb115-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1286"><a href="#cb115-1286" aria-hidden="true" tabindex="-1"></a>"*El aumento de la luz de la luna disminuye la actividad vocal de* Agalychnis lemur *aunque esta relación es mediada por la temperatura.*"</span>
<span id="cb115-1287"><a href="#cb115-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1288"><a href="#cb115-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "70%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-1289"><a href="#cb115-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1290"><a href="#cb115-1290" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/lemur.png")</span></span>
<span id="cb115-1291"><a href="#cb115-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1292"><a href="#cb115-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1293"><a href="#cb115-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1294"><a href="#cb115-1294" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1295"><a href="#cb115-1295" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1296"><a href="#cb115-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1297"><a href="#cb115-1297" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1298"><a href="#cb115-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1299"><a href="#cb115-1299" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-1300"><a href="#cb115-1300" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lectura: *Understanding 'it depends' in ecology: a guide to hypothesising, visualising and interpreting statistical interactions* {.unnumbered .unlisted}</span></span>
<span id="cb115-1301"><a href="#cb115-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1302"><a href="#cb115-1302" aria-hidden="true" tabindex="-1"></a>Los ecólogos utilizan habitualmente modelos estadísticos para detectar y explicar interacciones entre factores ecológicos, con el objetivo de evaluar si un efecto de interés cambia de signo o magnitud en distintos contextos. El artículo trata de los peligros de interpretan las interacciones estadísticas sin prestar atención a su propiedad fundamental de simetría, o a la escala de medida, ya sea aditiva o multiplicativa. <span class="co">[</span><span class="ot">Acá pueden acceder al artículo</span><span class="co">](https://onlinelibrary.wiley.com/doi/full/10.1111/brv.12939)</span>.</span>
<span id="cb115-1303"><a href="#cb115-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1304"><a href="#cb115-1304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-1305"><a href="#cb115-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1306"><a href="#cb115-1306" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/interaction.jpg")</span></span>
<span id="cb115-1307"><a href="#cb115-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1308"><a href="#cb115-1308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1309"><a href="#cb115-1309" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1310"><a href="#cb115-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1311"><a href="#cb115-1311" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1312"><a href="#cb115-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1313"><a href="#cb115-1313" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb115-1314"><a href="#cb115-1314" aria-hidden="true" tabindex="-1"></a>&lt;font size="5"&gt;Ejercicio 7&lt;/font&gt;</span>
<span id="cb115-1315"><a href="#cb115-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1316"><a href="#cb115-1316" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1317"><a href="#cb115-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1318"><a href="#cb115-1318" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Modifique el <span class="co">[</span><span class="ot">código usado para simular un único predictor asociado</span><span class="co">](#simular-un-predictor-asociado)</span> aumentando gradualmente el error. Esto se hace aumentando el argumento 'sd' en <span class="in">`error &lt;- rnorm(n = n, sd = 2)`</span>.</span>
<span id="cb115-1319"><a href="#cb115-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1320"><a href="#cb115-1320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mire cómo los errores más grandes afectan la inferencia (debe volver a correr los modelos)</span>
<span id="cb115-1321"><a href="#cb115-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1322"><a href="#cb115-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb115-1323"><a href="#cb115-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1324"><a href="#cb115-1324" aria-hidden="true" tabindex="-1"></a><span class="in"># definir semilla</span></span>
<span id="cb115-1325"><a href="#cb115-1325" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)</span></span>
<span id="cb115-1326"><a href="#cb115-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1327"><a href="#cb115-1327" aria-hidden="true" tabindex="-1"></a><span class="in"># numero de observaciones</span></span>
<span id="cb115-1328"><a href="#cb115-1328" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 50</span></span>
<span id="cb115-1329"><a href="#cb115-1329" aria-hidden="true" tabindex="-1"></a><span class="in">b0 &lt;- -4</span></span>
<span id="cb115-1330"><a href="#cb115-1330" aria-hidden="true" tabindex="-1"></a><span class="in">b1 &lt;- 3</span></span>
<span id="cb115-1331"><a href="#cb115-1331" aria-hidden="true" tabindex="-1"></a><span class="in">error &lt;- rnorm(n = n, sd = 10)</span></span>
<span id="cb115-1332"><a href="#cb115-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1333"><a href="#cb115-1333" aria-hidden="true" tabindex="-1"></a><span class="in">#  variables aleatorias</span></span>
<span id="cb115-1334"><a href="#cb115-1334" aria-hidden="true" tabindex="-1"></a><span class="in">x1 &lt;-  rnorm(n = n, mean = 0, sd = 1)</span></span>
<span id="cb115-1335"><a href="#cb115-1335" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- b0 + b1 * x1 + error</span></span>
<span id="cb115-1336"><a href="#cb115-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1337"><a href="#cb115-1337" aria-hidden="true" tabindex="-1"></a><span class="in"># crear data frame</span></span>
<span id="cb115-1338"><a href="#cb115-1338" aria-hidden="true" tabindex="-1"></a><span class="in">xy_datos &lt;- data.frame(x1, y)</span></span>
<span id="cb115-1339"><a href="#cb115-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1340"><a href="#cb115-1340" aria-hidden="true" tabindex="-1"></a><span class="in"># construir modelos</span></span>
<span id="cb115-1341"><a href="#cb115-1341" aria-hidden="true" tabindex="-1"></a><span class="in">summary(lm(formula = y ~ x1, data = xy_datos))</span></span>
<span id="cb115-1342"><a href="#cb115-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1343"><a href="#cb115-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1344"><a href="#cb115-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1345"><a href="#cb115-1345" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ahora reemplace el término de error con <span class="in">`error &lt;- rexp(n = n, rate = 0.2)`</span>. Esto crea un error con una distribución exponencial (por lo tanto no normal). Se supone que esto es problemático para el poder inferencial de estos modelos. Compare las estimaciones que obtuvo con los valores de la simulación ('b0' y 'b1'). Explore la distribución de los residuos (<span class="in">`plot(nombre_del_modelo)`</span>) para los modelos de error 'normal' y 'exponencial'.</span>
<span id="cb115-1346"><a href="#cb115-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1347"><a href="#cb115-1347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb115-1348"><a href="#cb115-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1349"><a href="#cb115-1349" aria-hidden="true" tabindex="-1"></a><span class="in"># definir semilla</span></span>
<span id="cb115-1350"><a href="#cb115-1350" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)</span></span>
<span id="cb115-1351"><a href="#cb115-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1352"><a href="#cb115-1352" aria-hidden="true" tabindex="-1"></a><span class="in"># numero de observaciones</span></span>
<span id="cb115-1353"><a href="#cb115-1353" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 50</span></span>
<span id="cb115-1354"><a href="#cb115-1354" aria-hidden="true" tabindex="-1"></a><span class="in">b0 &lt;- -4</span></span>
<span id="cb115-1355"><a href="#cb115-1355" aria-hidden="true" tabindex="-1"></a><span class="in">b1 &lt;- 3</span></span>
<span id="cb115-1356"><a href="#cb115-1356" aria-hidden="true" tabindex="-1"></a><span class="in">error &lt;- rnorm(n = n,  sd = 5)</span></span>
<span id="cb115-1357"><a href="#cb115-1357" aria-hidden="true" tabindex="-1"></a><span class="in">sd(error)</span></span>
<span id="cb115-1358"><a href="#cb115-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1359"><a href="#cb115-1359" aria-hidden="true" tabindex="-1"></a><span class="in">error &lt;- rexp(n = n, rate = 0.2)</span></span>
<span id="cb115-1360"><a href="#cb115-1360" aria-hidden="true" tabindex="-1"></a><span class="in">sd(error)</span></span>
<span id="cb115-1361"><a href="#cb115-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1362"><a href="#cb115-1362" aria-hidden="true" tabindex="-1"></a><span class="in">#  variables aleatorias</span></span>
<span id="cb115-1363"><a href="#cb115-1363" aria-hidden="true" tabindex="-1"></a><span class="in">x1 &lt;-  rnorm(n = n, mean = 0, sd = 1)</span></span>
<span id="cb115-1364"><a href="#cb115-1364" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- b0 + b1 * x1 + error</span></span>
<span id="cb115-1365"><a href="#cb115-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1366"><a href="#cb115-1366" aria-hidden="true" tabindex="-1"></a><span class="in"># crear data frame</span></span>
<span id="cb115-1367"><a href="#cb115-1367" aria-hidden="true" tabindex="-1"></a><span class="in">xy_datos &lt;- data.frame(x1, y)</span></span>
<span id="cb115-1368"><a href="#cb115-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1369"><a href="#cb115-1369" aria-hidden="true" tabindex="-1"></a><span class="in"># construir modelos</span></span>
<span id="cb115-1370"><a href="#cb115-1370" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- lm(formula = y ~ x1, data = xy_datos)</span></span>
<span id="cb115-1371"><a href="#cb115-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1372"><a href="#cb115-1372" aria-hidden="true" tabindex="-1"></a><span class="in">coef(mod)</span></span>
<span id="cb115-1373"><a href="#cb115-1373" aria-hidden="true" tabindex="-1"></a><span class="in">resd_mod &lt;- resid(mod)</span></span>
<span id="cb115-1374"><a href="#cb115-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1375"><a href="#cb115-1375" aria-hidden="true" tabindex="-1"></a><span class="in"># ver distribucion</span></span>
<span id="cb115-1376"><a href="#cb115-1376" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = data.frame(resd_mod), mapping = aes(x = resd_mod)) + geom_histogram() </span></span>
<span id="cb115-1377"><a href="#cb115-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1378"><a href="#cb115-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1379"><a href="#cb115-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1380"><a href="#cb115-1380" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Se supone que la colinealidad (la presencia de predictores correlacionados) afecta a la estabilidad de la regresión múltiple. El siguiente código crea dos predictores altamente colineales ('x1' y 'x2'). La última línea de código muestra la correlación entre ellos.</span>
<span id="cb115-1381"><a href="#cb115-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1384"><a href="#cb115-1384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1385"><a href="#cb115-1385" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-1386"><a href="#cb115-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-1387"><a href="#cb115-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1388"><a href="#cb115-1388" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-1389"><a href="#cb115-1389" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-1390"><a href="#cb115-1390" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb115-1391"><a href="#cb115-1391" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb115-1392"><a href="#cb115-1392" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb115-1393"><a href="#cb115-1393" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-1394"><a href="#cb115-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1395"><a href="#cb115-1395" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb115-1396"><a href="#cb115-1396" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-1397"><a href="#cb115-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1398"><a href="#cb115-1398" aria-hidden="true" tabindex="-1"></a><span class="co"># hacer x2 muy parecido a x1</span></span>
<span id="cb115-1399"><a href="#cb115-1399" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb115-1400"><a href="#cb115-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1401"><a href="#cb115-1401" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x1, x2)</span>
<span id="cb115-1402"><a href="#cb115-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1403"><a href="#cb115-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1404"><a href="#cb115-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1405"><a href="#cb115-1405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE, echo=FALSE}</span></span>
<span id="cb115-1406"><a href="#cb115-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1407"><a href="#cb115-1407" aria-hidden="true" tabindex="-1"></a><span class="in">xy_datos &lt;- data.frame(x1, x2, y)</span></span>
<span id="cb115-1408"><a href="#cb115-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1409"><a href="#cb115-1409" aria-hidden="true" tabindex="-1"></a><span class="in"># construir modelos</span></span>
<span id="cb115-1410"><a href="#cb115-1410" aria-hidden="true" tabindex="-1"></a><span class="in">xy_mod &lt;- lm(formula = y ~ x1 + x2, data = xy_datos)</span></span>
<span id="cb115-1411"><a href="#cb115-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1412"><a href="#cb115-1412" aria-hidden="true" tabindex="-1"></a><span class="in">summary(xy_mod)</span></span>
<span id="cb115-1413"><a href="#cb115-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1414"><a href="#cb115-1414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1415"><a href="#cb115-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1416"><a href="#cb115-1416" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Construya un modelo de regresión múltiple para estos datos (y \~ x1 + x2). Puede utilizar el mismo código que en la sección <span class="co">[</span><span class="ot">Añadir más de un predictor: regresión múltiple</span><span class="co">](#añadir-más-de-un-predictor:-regresión-múltiple)</span>.</span>
<span id="cb115-1417"><a href="#cb115-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1418"><a href="#cb115-1418" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>¿Cómo afecta a la inferencia la presencia de predictores colineales? Realice los gráficos de diagnóstico para este modelo (<span class="in">`plot(nombre_del_modelo)`</span>).</span>
<span id="cb115-1419"><a href="#cb115-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1420"><a href="#cb115-1420" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Simule un juego de datos con tres predictores en los que sólo dos de ellos son altamente colineales. Ajuste un modelo de regresión múltiple (y \~ x1 + x2 + x3) para esos datos y observe cómo la colinealidad afecta a la estimación del predictor no colineal.</span>
<span id="cb115-1421"><a href="#cb115-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1422"><a href="#cb115-1422" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1423"><a href="#cb115-1423" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1424"><a href="#cb115-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1425"><a href="#cb115-1425" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-1426"><a href="#cb115-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1427"><a href="#cb115-1427" aria-hidden="true" tabindex="-1"></a><span class="fu"># Extender los modelos lineales a estructuras de datos más complejas</span></span>
<span id="cb115-1428"><a href="#cb115-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1429"><a href="#cb115-1429" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1430"><a href="#cb115-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1431"><a href="#cb115-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelos lineales generalizados (GLM)</span></span>
<span id="cb115-1432"><a href="#cb115-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1433"><a href="#cb115-1433" aria-hidden="true" tabindex="-1"></a>Los GLM nos permiten modelar la asociación a variables respuesta que no siguen una distribución normal. Además, permiten modelar distribuciones que se asemejan más al proceso que generó los datos. El siguiente código crea un juego de datos con una respuesta que representa cuentas (por lo tanto, no normal):</span>
<span id="cb115-1434"><a href="#cb115-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1437"><a href="#cb115-1437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1438"><a href="#cb115-1438" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-1439"><a href="#cb115-1439" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb115-1440"><a href="#cb115-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1441"><a href="#cb115-1441" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de muestas</span></span>
<span id="cb115-1442"><a href="#cb115-1442" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb115-1443"><a href="#cb115-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1444"><a href="#cb115-1444" aria-hidden="true" tabindex="-1"></a><span class="co"># coeficientes</span></span>
<span id="cb115-1445"><a href="#cb115-1445" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb115-1446"><a href="#cb115-1446" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb115-1447"><a href="#cb115-1447" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb115-1448"><a href="#cb115-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1449"><a href="#cb115-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1450"><a href="#cb115-1450" aria-hidden="true" tabindex="-1"></a><span class="co">#generar variables</span></span>
<span id="cb115-1451"><a href="#cb115-1451" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> n, <span class="at">lambda =</span> <span class="fl">6.5</span>) <span class="co"># lambda = tasa promedio de exitos </span></span>
<span id="cb115-1452"><a href="#cb115-1452" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, , <span class="fu">length</span>(y))</span>
<span id="cb115-1453"><a href="#cb115-1453" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> (<span class="fu">log</span>(y) <span class="sc">-</span> b0 <span class="sc">-</span> b2 <span class="sc">*</span> x2) <span class="sc">/</span> b1</span>
<span id="cb115-1454"><a href="#cb115-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1455"><a href="#cb115-1455" aria-hidden="true" tabindex="-1"></a><span class="co"># crear data frame</span></span>
<span id="cb115-1456"><a href="#cb115-1456" aria-hidden="true" tabindex="-1"></a>xy_datos_pois <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb115-1457"><a href="#cb115-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1458"><a href="#cb115-1458" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_pois)</span>
<span id="cb115-1459"><a href="#cb115-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1460"><a href="#cb115-1460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1461"><a href="#cb115-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1462"><a href="#cb115-1462" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1463"><a href="#cb115-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1464"><a href="#cb115-1464" aria-hidden="true" tabindex="-1"></a>También grafiquemos 'x1' *vs* 'y':</span>
<span id="cb115-1465"><a href="#cb115-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1468"><a href="#cb115-1468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1469"><a href="#cb115-1469" aria-hidden="true" tabindex="-1"></a><span class="co"># graficar</span></span>
<span id="cb115-1470"><a href="#cb115-1470" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(xy_datos_pois, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb115-1471"><a href="#cb115-1471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb115-1472"><a href="#cb115-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1473"><a href="#cb115-1473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1474"><a href="#cb115-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1475"><a href="#cb115-1475" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1476"><a href="#cb115-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1477"><a href="#cb115-1477" aria-hidden="true" tabindex="-1"></a>La relación no parece muy lineal ni la varianza parece ser constante a través de 'x1'.</span>
<span id="cb115-1478"><a href="#cb115-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1479"><a href="#cb115-1479" aria-hidden="true" tabindex="-1"></a>Podemos relajar el requisito de la distribución normal con GLMs. <span class="in">`glm()`</span> es una función básica de R que nos ayuda a hacer el truco. Para este ejemplo la distribución más apropiada es *Poisson*. Esto se puede establecer en el argumento <span class="sc">\`</span>family' así:</span>
<span id="cb115-1480"><a href="#cb115-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1483"><a href="#cb115-1483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1484"><a href="#cb115-1484" aria-hidden="true" tabindex="-1"></a>glm_pois  <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos_pois, <span class="at">family =</span> <span class="fu">poisson</span>())</span>
<span id="cb115-1485"><a href="#cb115-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1486"><a href="#cb115-1486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1487"><a href="#cb115-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1488"><a href="#cb115-1488" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1489"><a href="#cb115-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1490"><a href="#cb115-1490" aria-hidden="true" tabindex="-1"></a>Que es equivalente a esto:</span>
<span id="cb115-1491"><a href="#cb115-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1492"><a href="#cb115-1492" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim_{poisson} \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1493"><a href="#cb115-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1494"><a href="#cb115-1494" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1495"><a href="#cb115-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1496"><a href="#cb115-1496" aria-hidden="true" tabindex="-1"></a>Como puede ver el único argumento extra comparado con <span class="in">`lm()`</span> es <span class="in">`family`</span>. El resto es simplemente la "fórmula" y los "datos" con los que ya estamos familiarizados. Así que, de nuevo, podemos aprovechar nuestros conocimientos sobre los modelos lineales para extenderlos a estructuras de datos más complejas.</span>
<span id="cb115-1497"><a href="#cb115-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1498"><a href="#cb115-1498" aria-hidden="true" tabindex="-1"></a>También necesitamos ejecutar <span class="in">`summary()`</span> para obtener el resultado del modelo:</span>
<span id="cb115-1499"><a href="#cb115-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1502"><a href="#cb115-1502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1503"><a href="#cb115-1503" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_pois)</span>
<span id="cb115-1504"><a href="#cb115-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1505"><a href="#cb115-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1506"><a href="#cb115-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1507"><a href="#cb115-1507" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1508"><a href="#cb115-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1509"><a href="#cb115-1509" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1510"><a href="#cb115-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1511"><a href="#cb115-1511" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb115-1512"><a href="#cb115-1512" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1513"><a href="#cb115-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1514"><a href="#cb115-1514" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Interpretación del modelo&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1515"><a href="#cb115-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1516"><a href="#cb115-1516" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1517"><a href="#cb115-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1518"><a href="#cb115-1518" aria-hidden="true" tabindex="-1"></a>Cuadro de los coeficientes (estimados):</span>
<span id="cb115-1519"><a href="#cb115-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1520"><a href="#cb115-1520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb115-1521"><a href="#cb115-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1522"><a href="#cb115-1522" aria-hidden="true" tabindex="-1"></a><span class="in">summ_glm_pois &lt;- summary(glm_pois)</span></span>
<span id="cb115-1523"><a href="#cb115-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1524"><a href="#cb115-1524" aria-hidden="true" tabindex="-1"></a><span class="in">summ_glm_pois$coefficients</span></span>
<span id="cb115-1525"><a href="#cb115-1525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1526"><a href="#cb115-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1527"><a href="#cb115-1527" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo nos dice que $\beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_glm_pois$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_glm_pois$coefficients[2, 4]`</span>). Esto se interpreta en realidad como que un aumento de 1 unidad de 'x1' resulta en 'y' (tasa) en un factor de exp(<span class="in">`r summ_glm_pois$coefficients[2, 1]`</span>) = <span class="in">`r exp(summ_glm_pois$coefficients[2, 1])`</span>.</span>
<span id="cb115-1528"><a href="#cb115-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1529"><a href="#cb115-1529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo también nos dice que $\beta_2$ (el tamaño de efecto de 'x2') es <span class="in">`r summ_glm_pois$coefficients[3, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_glm_pois$coefficients[3, 4]`</span>). Esto significa que un aumento en 1 unidad de 'x2' resulta en 'y' (tasa) en un factor de exp(<span class="in">`r summ_glm_pois$coefficients[3, 1]`</span>) = <span class="in">`r exp(summ_glm_pois$coefficients[3, 1])`</span>.</span>
<span id="cb115-1530"><a href="#cb115-1530" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1531"><a href="#cb115-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1532"><a href="#cb115-1532" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1533"><a href="#cb115-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1534"><a href="#cb115-1534" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-1535"><a href="#cb115-1535" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Caso de estudio&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1536"><a href="#cb115-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1537"><a href="#cb115-1537" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1538"><a href="#cb115-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1539"><a href="#cb115-1539" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Topp, E. N., Tscharntke, T., &amp; Loos, J. (2022). <span class="co">[</span><span class="ot">**Fire and landscape context shape plant and butterfly diversity in a South African shrubland**</span><span class="co">](https://onlinelibrary.wiley.com/doi/pdf/10.1111/ddi.13257)</span>. *Diversity and Distributions*, 28(3), 357-371.</span>
<span id="cb115-1540"><a href="#cb115-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1541"><a href="#cb115-1541" aria-hidden="true" tabindex="-1"></a>"*La riqueza de especies de mariposas es de tres a cuatro veces mayor cuando aumenta el hábitat natural en el paisaje circundante (en un radio de 2 km), mientras que la abundancia de mariposas se asociaba negativamente con el aumento del tiempo transcurrido desde el último incendio.*"</span>
<span id="cb115-1542"><a href="#cb115-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1543"><a href="#cb115-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-1544"><a href="#cb115-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1545"><a href="#cb115-1545" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/butterflies.png")</span></span>
<span id="cb115-1546"><a href="#cb115-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1547"><a href="#cb115-1547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1548"><a href="#cb115-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1549"><a href="#cb115-1549" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1550"><a href="#cb115-1550" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1551"><a href="#cb115-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1552"><a href="#cb115-1552" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1553"><a href="#cb115-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1554"><a href="#cb115-1554" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb115-1555"><a href="#cb115-1555" aria-hidden="true" tabindex="-1"></a>&lt;font size="5"&gt;Ejercicio 8&lt;/font&gt;</span>
<span id="cb115-1556"><a href="#cb115-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1557"><a href="#cb115-1557" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1558"><a href="#cb115-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1559"><a href="#cb115-1559" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Intente correr el modelo anterior <span class="in">`lm()`</span> (con una distribución gaussiana), compare los resultados y compruebe los residuos (<span class="in">`plot_model(model_name, type = "diag")`</span>)</span>
<span id="cb115-1560"><a href="#cb115-1560" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1561"><a href="#cb115-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1562"><a href="#cb115-1562" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1563"><a href="#cb115-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1564"><a href="#cb115-1564" aria-hidden="true" tabindex="-1"></a>Existen muchas otras funciones de distribución y enlace:</span>
<span id="cb115-1565"><a href="#cb115-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1566"><a href="#cb115-1566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "80%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-1567"><a href="#cb115-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1568"><a href="#cb115-1568" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/link-functions.jpg")</span></span>
<span id="cb115-1569"><a href="#cb115-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1570"><a href="#cb115-1570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1571"><a href="#cb115-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1572"><a href="#cb115-1572" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1573"><a href="#cb115-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1574"><a href="#cb115-1574" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-1575"><a href="#cb115-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1576"><a href="#cb115-1576" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelos de efectos variables (modelos mixtos)</span></span>
<span id="cb115-1577"><a href="#cb115-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1578"><a href="#cb115-1578" aria-hidden="true" tabindex="-1"></a>A veces nuestros conjuntos de datos incluyen estructuras con varios niveles de organización. Por ejemplo, cuando tomamos muestras de varios individuos de diferentes poblaciones. En esos casos, la variación en el nivel estructural superior (poblaciones) podría impedir la detección de patrones en el nivel inferior (individuos).</span>
<span id="cb115-1579"><a href="#cb115-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1580"><a href="#cb115-1580" aria-hidden="true" tabindex="-1"></a>Vamos a simular algunos datos que se asemejan a ese escenario. Tenemos dos predictores continuos (x1) y una respuesta continua (y). Cada muestra procede de 1 de 8 poblaciones diferentes (poblacion):</span>
<span id="cb115-1581"><a href="#cb115-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1584"><a href="#cb115-1584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1585"><a href="#cb115-1585" aria-hidden="true" tabindex="-1"></a><span class="co"># x&lt;- 1</span></span>
<span id="cb115-1586"><a href="#cb115-1586" aria-hidden="true" tabindex="-1"></a><span class="co"># definir semilla</span></span>
<span id="cb115-1587"><a href="#cb115-1587" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb115-1588"><a href="#cb115-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1589"><a href="#cb115-1589" aria-hidden="true" tabindex="-1"></a><span class="co"># numero de observaciones</span></span>
<span id="cb115-1590"><a href="#cb115-1590" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb115-1591"><a href="#cb115-1591" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb115-1592"><a href="#cb115-1592" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb115-1593"><a href="#cb115-1593" aria-hidden="true" tabindex="-1"></a>poblacion <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb115-1594"><a href="#cb115-1594" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb115-1595"><a href="#cb115-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1596"><a href="#cb115-1596" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb115-1597"><a href="#cb115-1597" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-1598"><a href="#cb115-1598" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> poblacion <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb115-1599"><a href="#cb115-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1600"><a href="#cb115-1600" aria-hidden="true" tabindex="-1"></a><span class="co"># add letters</span></span>
<span id="cb115-1601"><a href="#cb115-1601" aria-hidden="true" tabindex="-1"></a>poblacion <span class="ot">&lt;-</span> letters[poblacion <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb115-1602"><a href="#cb115-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1603"><a href="#cb115-1603" aria-hidden="true" tabindex="-1"></a><span class="co"># create data set</span></span>
<span id="cb115-1604"><a href="#cb115-1604" aria-hidden="true" tabindex="-1"></a>xy_datos_mixto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y, poblacion)</span>
<span id="cb115-1605"><a href="#cb115-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1606"><a href="#cb115-1606" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xy_datos_mixto, <span class="dv">10</span>)</span>
<span id="cb115-1607"><a href="#cb115-1607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1608"><a href="#cb115-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1609"><a href="#cb115-1609" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1610"><a href="#cb115-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1611"><a href="#cb115-1611" aria-hidden="true" tabindex="-1"></a>Podemos explorar la relación entre 'y' y 'x1' con un gráfico:</span>
<span id="cb115-1612"><a href="#cb115-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1615"><a href="#cb115-1615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1616"><a href="#cb115-1616" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb115-1617"><a href="#cb115-1617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb115-1618"><a href="#cb115-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1619"><a href="#cb115-1619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1620"><a href="#cb115-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1621"><a href="#cb115-1621" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1622"><a href="#cb115-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1623"><a href="#cb115-1623" aria-hidden="true" tabindex="-1"></a>¿Puede ver claramente el patrón de asociación entre las dos variables que hemos utilizado para simular los datos? Podemos seguir explorando los datos con un modelo de regresión lineal simple:</span>
<span id="cb115-1624"><a href="#cb115-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1627"><a href="#cb115-1627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1628"><a href="#cb115-1628" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos_mixto))</span>
<span id="cb115-1629"><a href="#cb115-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1630"><a href="#cb115-1630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1631"><a href="#cb115-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1632"><a href="#cb115-1632" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1633"><a href="#cb115-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1634"><a href="#cb115-1634" aria-hidden="true" tabindex="-1"></a>A pesar de haber simulado un $\beta_1$ distinto de cero, no tenemos ninguna asociación significativa según este modelo y la estimación de $\beta_1$ está muy lejos de la simulada. Esta pobre inferencia se debe a que estamos ignorando una característica importante de nuestros datos, la agrupación de las muestras en "poblaciones".</span>
<span id="cb115-1635"><a href="#cb115-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1636"><a href="#cb115-1636" aria-hidden="true" tabindex="-1"></a>Los modelos de efectos mixtos (también conocidos como modelos multinivel o modelos de efectos variables) pueden ayudarnos a tener en cuenta estas características adicionales, mejorando significativamente nuestro poder de inferencia. Coloreemos cada una de las poblaciones para ver cómo covarían las variables en cada subgrupo de datos:</span>
<span id="cb115-1637"><a href="#cb115-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1640"><a href="#cb115-1640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1641"><a href="#cb115-1641" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">color =</span> poblacion)) <span class="sc">+</span> </span>
<span id="cb115-1642"><a href="#cb115-1642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb115-1643"><a href="#cb115-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1644"><a href="#cb115-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1645"><a href="#cb115-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1646"><a href="#cb115-1646" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1647"><a href="#cb115-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1648"><a href="#cb115-1648" aria-hidden="true" tabindex="-1"></a>Parece haber un patrón claro de asociación positiva entre x1 e y. El patrón se hace un poco más evidente si mostramos cada población en su propio panel:</span>
<span id="cb115-1649"><a href="#cb115-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1650"><a href="#cb115-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width= "100%"}</span></span>
<span id="cb115-1651"><a href="#cb115-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1652"><a href="#cb115-1652" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = xy_datos_mixto, aes(x = x1, y = y, color = poblacion)) +</span></span>
<span id="cb115-1653"><a href="#cb115-1653" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() +</span></span>
<span id="cb115-1654"><a href="#cb115-1654" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap( ~ poblacion) +</span></span>
<span id="cb115-1655"><a href="#cb115-1655" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", se = FALSE) </span></span>
<span id="cb115-1656"><a href="#cb115-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1657"><a href="#cb115-1657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1658"><a href="#cb115-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1659"><a href="#cb115-1659" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1660"><a href="#cb115-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1661"><a href="#cb115-1661" aria-hidden="true" tabindex="-1"></a>Construyamos un modelo de efectos mixtos utilizando la población como intercepto variable:</span>
<span id="cb115-1662"><a href="#cb115-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1665"><a href="#cb115-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1666"><a href="#cb115-1666" aria-hidden="true" tabindex="-1"></a>mix_eff_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> poblacion), <span class="at">data =</span> xy_datos_mixto)</span>
<span id="cb115-1667"><a href="#cb115-1667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1668"><a href="#cb115-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1669"><a href="#cb115-1669" aria-hidden="true" tabindex="-1"></a>Que es equivalente a esto:</span>
<span id="cb115-1670"><a href="#cb115-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1671"><a href="#cb115-1671" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 6&gt;$\hat{Y} \sim_{gausiana} (\beta_{o} + \beta_{grupo}) + \beta_{1} * x_{1}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1672"><a href="#cb115-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1673"><a href="#cb115-1673" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1674"><a href="#cb115-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1675"><a href="#cb115-1675" aria-hidden="true" tabindex="-1"></a>Podemos ver el resultado del modelo igual que con un modelo <span class="in">`lm()`</span>:</span>
<span id="cb115-1676"><a href="#cb115-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1679"><a href="#cb115-1679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1680"><a href="#cb115-1680" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mix_eff_mod)</span>
<span id="cb115-1681"><a href="#cb115-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1682"><a href="#cb115-1682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1683"><a href="#cb115-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1684"><a href="#cb115-1684" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1685"><a href="#cb115-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1686"><a href="#cb115-1686" aria-hidden="true" tabindex="-1"></a>El modelo detectó correctamente el patrón simulado y la estimación de $\beta_1$ (<span class="in">`r round(fixef(mix_eff_mod)[2], 3)`</span>) es muy cercana al valor simulado.</span>
<span id="cb115-1687"><a href="#cb115-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1688"><a href="#cb115-1688" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1689"><a href="#cb115-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1690"><a href="#cb115-1690" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb115-1691"><a href="#cb115-1691" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Caso de estudio&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1692"><a href="#cb115-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1693"><a href="#cb115-1693" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1694"><a href="#cb115-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1695"><a href="#cb115-1695" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Araya-Salas M, P González-Gómez, K Wojczulanis-Jakubas, V López III &amp; T Wright. 2018. <span class="co">[</span><span class="ot">**Spatial memory is as important as weapon and body size for territorial ownership in a lekking hummingbird**</span><span class="co">](https://www.nature.com/articles/s41598-018-20441-x)</span>. *Scientific Reports*. 13, e0189969</span>
<span id="cb115-1696"><a href="#cb115-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1697"><a href="#cb115-1697" aria-hidden="true" tabindex="-1"></a>"*... el tamaño corporal mostró una correlación negativa con la frecuencia baja del canto.*"</span>
<span id="cb115-1698"><a href="#cb115-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1699"><a href="#cb115-1699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "80%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-1700"><a href="#cb115-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1701"><a href="#cb115-1701" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/lbh_song_size.png")</span></span>
<span id="cb115-1702"><a href="#cb115-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1703"><a href="#cb115-1703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1704"><a href="#cb115-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1705"><a href="#cb115-1705" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1706"><a href="#cb115-1706" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1707"><a href="#cb115-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1708"><a href="#cb115-1708" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1709"><a href="#cb115-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1710"><a href="#cb115-1710" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb115-1711"><a href="#cb115-1711" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1712"><a href="#cb115-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1713"><a href="#cb115-1713" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size="5"&gt;&lt;b&gt;Interpretación del modelo&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1714"><a href="#cb115-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1715"><a href="#cb115-1715" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1716"><a href="#cb115-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1717"><a href="#cb115-1717" aria-hidden="true" tabindex="-1"></a>Cuadro con los coeficientes (estimados):</span>
<span id="cb115-1718"><a href="#cb115-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1719"><a href="#cb115-1719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb115-1720"><a href="#cb115-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1721"><a href="#cb115-1721" aria-hidden="true" tabindex="-1"></a><span class="in">summ_mix_eff_mod &lt;- summary(mix_eff_mod)</span></span>
<span id="cb115-1722"><a href="#cb115-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1723"><a href="#cb115-1723" aria-hidden="true" tabindex="-1"></a><span class="in">summ_mix_eff_mod$coefficients</span></span>
<span id="cb115-1724"><a href="#cb115-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1725"><a href="#cb115-1725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1726"><a href="#cb115-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1727"><a href="#cb115-1727" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1728"><a href="#cb115-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1729"><a href="#cb115-1729" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>El modelo encontró que $\beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_mix_eff_mod$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_mix_eff_mod$coefficients[2, 5]`</span>)</span>
<span id="cb115-1730"><a href="#cb115-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1731"><a href="#cb115-1731" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lmer()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb115-1732"><a href="#cb115-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1733"><a href="#cb115-1733" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_1$ se fijó en <span class="in">`r b1`</span> y se estimó como <span class="in">`r round(summ_mix_eff_mod$coefficients[2, 1], 3)`</span>.</span>
<span id="cb115-1734"><a href="#cb115-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1735"><a href="#cb115-1735" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>La varianza del intercepto para cada población fue de <span class="in">`r var(ranef(mix_eff_mod)$poblacion[,1])`</span> y la desviación estándar de <span class="in">`r sd(ranef(mix_eff_mod)$poblacion[,1])`</span></span>
<span id="cb115-1736"><a href="#cb115-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1737"><a href="#cb115-1737" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Los interceptos estimados para cada población son:</span>
<span id="cb115-1738"><a href="#cb115-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1741"><a href="#cb115-1741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1742"><a href="#cb115-1742" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(mix_eff_mod)<span class="sc">$</span>poblacion</span>
<span id="cb115-1743"><a href="#cb115-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1744"><a href="#cb115-1744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1745"><a href="#cb115-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1746"><a href="#cb115-1746" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1747"><a href="#cb115-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1748"><a href="#cb115-1748" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Podemos compararlos con los promedios para cada población en los datos:</span>
<span id="cb115-1749"><a href="#cb115-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1752"><a href="#cb115-1752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-1753"><a href="#cb115-1753" aria-hidden="true" tabindex="-1"></a><span class="co"># sumar interceptos por poblacion a el intercepto total</span></span>
<span id="cb115-1754"><a href="#cb115-1754" aria-hidden="true" tabindex="-1"></a>interceptos <span class="ot">&lt;-</span> <span class="fu">ranef</span>(mix_eff_mod)<span class="sc">$</span>poblacion <span class="sc">+</span> <span class="fu">fixef</span>(mix_eff_mod)[<span class="dv">1</span>]</span>
<span id="cb115-1755"><a href="#cb115-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1756"><a href="#cb115-1756" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular los promedios por poblacion en los datos </span></span>
<span id="cb115-1757"><a href="#cb115-1757" aria-hidden="true" tabindex="-1"></a>prom_pobs <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(y <span class="sc">~</span> poblacion, xy_datos_mixto, mean)</span>
<span id="cb115-1758"><a href="#cb115-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1759"><a href="#cb115-1759" aria-hidden="true" tabindex="-1"></a><span class="co"># unir</span></span>
<span id="cb115-1760"><a href="#cb115-1760" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(interceptos, <span class="at">prom_pobs=</span> prom_pobs[,<span class="dv">2</span>])</span>
<span id="cb115-1761"><a href="#cb115-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1762"><a href="#cb115-1762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1763"><a href="#cb115-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1764"><a href="#cb115-1764" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1765"><a href="#cb115-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1766"><a href="#cb115-1766" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>La varianza entre los niveles del factor aleatorio (<span class="in">`poblacion`</span>) es de <span class="in">`r var(ranef(mix_eff_mod)$poblacion[,1])`</span> y la desviación estándar de <span class="in">`r sd(ranef(mix_eff_mod)$poblacion[,1])`</span></span>
<span id="cb115-1767"><a href="#cb115-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1768"><a href="#cb115-1768" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1769"><a href="#cb115-1769" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1770"><a href="#cb115-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1771"><a href="#cb115-1771" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1772"><a href="#cb115-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1773"><a href="#cb115-1773" aria-hidden="true" tabindex="-1"></a><span class="fu">### La paradoja de Simpson</span></span>
<span id="cb115-1774"><a href="#cb115-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1775"><a href="#cb115-1775" aria-hidden="true" tabindex="-1"></a>La paradoja de Simpson es un fenómeno en estadística en el que una tendencia aparece en varios grupos de datos pero desaparece o se invierte cuando se combinan los grupos. Se ha utilizado para ilustrar el tipo de resultados engañosos que puede generar el ignorar la estructura en los datos y las relaciones causales entre variables.</span>
<span id="cb115-1776"><a href="#cb115-1776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1777"><a href="#cb115-1777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "80%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-1778"><a href="#cb115-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1779"><a href="#cb115-1779" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/simpsons_paradox.gif")</span></span>
<span id="cb115-1780"><a href="#cb115-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1781"><a href="#cb115-1781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1782"><a href="#cb115-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1783"><a href="#cb115-1783" aria-hidden="true" tabindex="-1"></a>&lt;font size="3"&gt;Tomado de wikipedia&lt;/font&gt;</span>
<span id="cb115-1784"><a href="#cb115-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1785"><a href="#cb115-1785" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1786"><a href="#cb115-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1787"><a href="#cb115-1787" aria-hidden="true" tabindex="-1"></a>La estructura de los datos debido a observaciones pertenecientes al mismo grupo puede ser tomada en cuenta usando el grupo como un factor aleatorio, tal y como se hizo en el ejemplo anterior.</span>
<span id="cb115-1788"><a href="#cb115-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1789"><a href="#cb115-1789" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1790"><a href="#cb115-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1791"><a href="#cb115-1791" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb115-1792"><a href="#cb115-1792" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;b&gt;&lt;font size="5"&gt;Modelos lineales como abordaje estadístico estándar para la inferencia causal &lt;/font&gt;&lt;/b&gt;&lt;/center&gt;</span>
<span id="cb115-1793"><a href="#cb115-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1794"><a href="#cb115-1794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, out.width = "40%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb115-1795"><a href="#cb115-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1796"><a href="#cb115-1796" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./images/swiss_knife.png")</span></span>
<span id="cb115-1797"><a href="#cb115-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1798"><a href="#cb115-1798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-1799"><a href="#cb115-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1800"><a href="#cb115-1800" aria-hidden="true" tabindex="-1"></a>&lt;center&gt;&lt;font size = 5&gt;$\hat{Y} \sim_{función\ de\ enlace} (\beta_{o} + \beta_{grupo}) + \beta_{1} * x_{1} + \cdots + \beta_{n} * x_{n}$&lt;/font&gt;&lt;/center&gt;</span>
<span id="cb115-1801"><a href="#cb115-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1802"><a href="#cb115-1802" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Este modelo básico incluye una función de enlace que cuando es gausiana (i.e. normal) equivale a un modelo lineal y cuando no, a un modelo generalizado</span>
<span id="cb115-1803"><a href="#cb115-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1804"><a href="#cb115-1804" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cuando el $\beta_{grupo}$ es diferente entre grupos (i.e. cuando el intercepto difiere entre grupos) es un modelo mixto con intercepto variable (i.e. aleatorio)</span>
<span id="cb115-1805"><a href="#cb115-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1806"><a href="#cb115-1806" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1807"><a href="#cb115-1807" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-1808"><a href="#cb115-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1809"><a href="#cb115-1809" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1810"><a href="#cb115-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1811"><a href="#cb115-1811" aria-hidden="true" tabindex="-1"></a>Este manual solo pretende sugerir un abordaje estadístico centrado en los modelos de regresión desde el cual se pueden llevar a cabo adecuadamente la mayoría de los análisis estadísticos que usamos en biología. **El manual no tiene como objetivo explicar en detalle las particularidades de los modelos generalizados y mixtos**. Note que estos modelos, principalmente los mixtos, pueden adaptarse a otras estructuras de datos mas complejas no cubiertas aquí, como lo son las pendientes aleatorias, pendientes e interceptos aleatorios, estructuras de correlación (i.e. autocorrelación espacial o temporal, pedigrís o árboles filogenéticos), medidas repetidas y el uso de pseudoreplicas, entre otras.</span>
<span id="cb115-1812"><a href="#cb115-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1813"><a href="#cb115-1813" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb115-1814"><a href="#cb115-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1815"><a href="#cb115-1815" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-1816"><a href="#cb115-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1817"><a href="#cb115-1817" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referencias</span></span>
<span id="cb115-1818"><a href="#cb115-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1819"><a href="#cb115-1819" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Richard McElreath's Statistical Rethinking book</span><span class="co">](https://github.com/rmcelreath/stat_rethinking_2022)</span></span>
<span id="cb115-1820"><a href="#cb115-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1821"><a href="#cb115-1821" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R's rbinom -- Simulate Binomial or Bernoulli trials</span><span class="co">](https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rbinom/)</span></span>
<span id="cb115-1822"><a href="#cb115-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1823"><a href="#cb115-1823" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R's rnorm -- selecting values from a normal distribution</span><span class="co">](https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rnorm/)</span></span>
<span id="cb115-1824"><a href="#cb115-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1825"><a href="#cb115-1825" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R's exp -- Simulating Exponential Distributions</span><span class="co">](https://www.programmingr.com/examples/neat-tricks/sample-r-function/rexp/)</span></span>
<span id="cb115-1826"><a href="#cb115-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1827"><a href="#cb115-1827" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Simulating data in R</span><span class="co">](https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/)</span></span>
<span id="cb115-1828"><a href="#cb115-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1829"><a href="#cb115-1829" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Spake, R., Bowler, D. E., Callaghan, C. T., Blowes, S. A., Doncaster, C. P., Antao, L. H., ... &amp; Chase, J. M. (2023). <span class="co">[</span><span class="ot">Understanding 'it depends' in ecology: a guide to hypothesising, visualising and interpreting statistical interactions</span><span class="co">](https://onlinelibrary.wiley.com/doi/full/10.1111/brv.12939)</span>. Biological Reviews.</span>
<span id="cb115-1830"><a href="#cb115-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1831"><a href="#cb115-1831" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Complete introduction to linear regression in R</span><span class="co">](https://www.machinelearningplus.com/machine-learning/complete-introduction-linear-regression-r/)</span></span>
<span id="cb115-1832"><a href="#cb115-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1833"><a href="#cb115-1833" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Linear regression in R</span><span class="co">](https://www.scribbr.com/statistics/linear-regression-in-r/)</span></span>
<span id="cb115-1834"><a href="#cb115-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1835"><a href="#cb115-1835" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Harrison, X. A., Donaldson, L., Correa-Cano, M. E., Evans, J., Fisher, D. N., Goodwin, C. E., &amp; Inger, R. (2018). <span class="co">[</span><span class="ot">A brief introduction to mixed effects modelling and multi-model inference in ecology</span><span class="co">](https://peerj.com/articles/4794/)</span>. *PeerJ*, 6, e4794.</span>
<span id="cb115-1836"><a href="#cb115-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1837"><a href="#cb115-1837" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb115-1838"><a href="#cb115-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1839"><a href="#cb115-1839" aria-hidden="true" tabindex="-1"></a><span class="fu"># Información de la sesión {.unnumbered .unlisted}</span></span>
<span id="cb115-1840"><a href="#cb115-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1841"><a href="#cb115-1841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb115-1842"><a href="#cb115-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1843"><a href="#cb115-1843" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb115-1844"><a href="#cb115-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-1845"><a href="#cb115-1845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024 | <a href="https://marce10.github.io">Marcelo Araya-Salas</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>